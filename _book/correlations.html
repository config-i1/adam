<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.6 Correlation and measures of association | Forecasting and Analytics with ADAM</title>
  <meta name="description" content="This textbook explains how to do time series analysis and forecasting using Augmented Dynamic Adaptive Model, implemented in smooth package for R." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="2.6 Correlation and measures of association | Forecasting and Analytics with ADAM" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This textbook explains how to do time series analysis and forecasting using Augmented Dynamic Adaptive Model, implemented in smooth package for R." />
  <meta name="github-repo" content="config-i1/adam" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.6 Correlation and measures of association | Forecasting and Analytics with ADAM" />
  
  <meta name="twitter:description" content="This textbook explains how to do time series analysis and forecasting using Augmented Dynamic Adaptive Model, implemented in smooth package for R." />
  

<meta name="author" content="Ivan Svetunkov" />


<meta name="date" content="2021-07-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="hypothesisTesting.html"/>
<link rel="next" href="distributions.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XH37Z8VYP8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XH37Z8VYP8');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Forecasting and Analytics with ADAM</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-is-adam"><i class="fa fa-check"></i>What is ADAM?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="modelsMethods.html"><a href="modelsMethods.html"><i class="fa fa-check"></i><b>1.1</b> Models, methods et al. </a></li>
<li class="chapter" data-level="1.2" data-path="scales.html"><a href="scales.html"><i class="fa fa-check"></i><b>1.2</b> Scales of information</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="scales.html"><a href="scales.html#nominal-scale"><i class="fa fa-check"></i><b>1.2.1</b> Nominal scale</a></li>
<li class="chapter" data-level="1.2.2" data-path="scales.html"><a href="scales.html#ordinal-scale"><i class="fa fa-check"></i><b>1.2.2</b> Ordinal scale</a></li>
<li class="chapter" data-level="1.2.3" data-path="scales.html"><a href="scales.html#interval-scale"><i class="fa fa-check"></i><b>1.2.3</b> Interval scale</a></li>
<li class="chapter" data-level="1.2.4" data-path="scales.html"><a href="scales.html#ratio-scale"><i class="fa fa-check"></i><b>1.2.4</b> Ratio scale</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>2</b> Introduction to statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="dataAnalysis.html"><a href="dataAnalysis.html"><i class="fa fa-check"></i><b>2.1</b> Preliminary data analysis</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="dataAnalysis.html"><a href="dataAnalysis.html#numerical-analysis"><i class="fa fa-check"></i><b>2.1.1</b> Numerical analysis</a></li>
<li class="chapter" data-level="2.1.2" data-path="dataAnalysis.html"><a href="dataAnalysis.html#dataAnalysisGraphical"><i class="fa fa-check"></i><b>2.1.2</b> Graphical analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="LLNandCLT.html"><a href="LLNandCLT.html"><i class="fa fa-check"></i><b>2.2</b> Law of Large Numbers and Central Limit Theorem</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="LLNandCLT.html"><a href="LLNandCLT.html#LLN"><i class="fa fa-check"></i><b>2.2.1</b> Law of Large Numbers</a></li>
<li class="chapter" data-level="2.2.2" data-path="LLNandCLT.html"><a href="LLNandCLT.html#CLT"><i class="fa fa-check"></i><b>2.2.2</b> Central Limit Theorem</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="estimatesProperties.html"><a href="estimatesProperties.html"><i class="fa fa-check"></i><b>2.3</b> Properties of estimators</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="estimatesProperties.html"><a href="estimatesProperties.html#estimatesPropertiesBias"><i class="fa fa-check"></i><b>2.3.1</b> Bias</a></li>
<li class="chapter" data-level="2.3.2" data-path="estimatesProperties.html"><a href="estimatesProperties.html#estimatesPropertiesEfficiency"><i class="fa fa-check"></i><b>2.3.2</b> Efficiency</a></li>
<li class="chapter" data-level="2.3.3" data-path="estimatesProperties.html"><a href="estimatesProperties.html#estimatesPropertiesConsistency"><i class="fa fa-check"></i><b>2.3.3</b> Consistency</a></li>
<li class="chapter" data-level="2.3.4" data-path="estimatesProperties.html"><a href="estimatesProperties.html#asymptoticNormality"><i class="fa fa-check"></i><b>2.3.4</b> Asymptotic normality</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="confidenceIntervals.html"><a href="confidenceIntervals.html"><i class="fa fa-check"></i><b>2.4</b> Confidence and prediction intervals</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="confidenceIntervals.html"><a href="confidenceIntervals.html#confidence-interval"><i class="fa fa-check"></i><b>2.4.1</b> Confidence interval</a></li>
<li class="chapter" data-level="2.4.2" data-path="confidenceIntervals.html"><a href="confidenceIntervals.html#prediction-interval"><i class="fa fa-check"></i><b>2.4.2</b> Prediction interval</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="hypothesisTesting.html"><a href="hypothesisTesting.html"><i class="fa fa-check"></i><b>2.5</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="hypothesisTesting.html"><a href="hypothesisTesting.html#hypothesisTestingMistakes"><i class="fa fa-check"></i><b>2.5.1</b> Common mistakes related to hypothesis testing</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="correlations.html"><a href="correlations.html"><i class="fa fa-check"></i><b>2.6</b> Correlation and measures of association</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="correlations.html"><a href="correlations.html#nominal-scale-1"><i class="fa fa-check"></i><b>2.6.1</b> Nominal scale</a></li>
<li class="chapter" data-level="2.6.2" data-path="correlations.html"><a href="correlations.html#ordinal-scale-1"><i class="fa fa-check"></i><b>2.6.2</b> Ordinal scale</a></li>
<li class="chapter" data-level="2.6.3" data-path="correlations.html"><a href="correlations.html#correlationCoefficient"><i class="fa fa-check"></i><b>2.6.3</b> Numerical scale</a></li>
<li class="chapter" data-level="2.6.4" data-path="correlations.html"><a href="correlations.html#correlationsMixed"><i class="fa fa-check"></i><b>2.6.4</b> Mixed scales</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>2.7</b> Theory of distributions</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="distributions.html"><a href="distributions.html#distributionsNormal"><i class="fa fa-check"></i><b>2.7.1</b> Normal distribution</a></li>
<li class="chapter" data-level="2.7.2" data-path="distributions.html"><a href="distributions.html#distributionsLaplace"><i class="fa fa-check"></i><b>2.7.2</b> Laplace distribution</a></li>
<li class="chapter" data-level="2.7.3" data-path="distributions.html"><a href="distributions.html#s-distribution"><i class="fa fa-check"></i><b>2.7.3</b> S distribution</a></li>
<li class="chapter" data-level="2.7.4" data-path="distributions.html"><a href="distributions.html#distributionsGeneralisedNormal"><i class="fa fa-check"></i><b>2.7.4</b> Generalised Normal distribution</a></li>
<li class="chapter" data-level="2.7.5" data-path="distributions.html"><a href="distributions.html#distributionsALaplace"><i class="fa fa-check"></i><b>2.7.5</b> Asymmetric Laplace distribution</a></li>
<li class="chapter" data-level="2.7.6" data-path="distributions.html"><a href="distributions.html#log-normal-log-laplace-log-s-and-log-gn-distributions"><i class="fa fa-check"></i><b>2.7.6</b> Log Normal, Log Laplace, Log S and Log GN distributions</a></li>
<li class="chapter" data-level="2.7.7" data-path="distributions.html"><a href="distributions.html#IGDistribution"><i class="fa fa-check"></i><b>2.7.7</b> Inverse Gaussian distribution</a></li>
<li class="chapter" data-level="2.7.8" data-path="distributions.html"><a href="distributions.html#GammaDistribution"><i class="fa fa-check"></i><b>2.7.8</b> Gamma distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>3</b> Regression analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simpleLinearRegression.html"><a href="simpleLinearRegression.html"><i class="fa fa-check"></i><b>3.1</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="simpleLinearRegression.html"><a href="simpleLinearRegression.html#OLS"><i class="fa fa-check"></i><b>3.1.1</b> Ordinary Least Squares (OLS)</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="linearRegression.html"><a href="linearRegression.html"><i class="fa fa-check"></i><b>3.2</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="linearRegression.html"><a href="linearRegression.html#ols-estimation"><i class="fa fa-check"></i><b>3.2.1</b> OLS estimation</a></li>
<li class="chapter" data-level="3.2.2" data-path="linearRegression.html"><a href="linearRegression.html#linearRegressionQualityOfFit"><i class="fa fa-check"></i><b>3.2.2</b> Quality of a fit</a></li>
<li class="chapter" data-level="3.2.3" data-path="linearRegression.html"><a href="linearRegression.html#interpretation-of-parameters"><i class="fa fa-check"></i><b>3.2.3</b> Interpretation of parameters</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="regression-uncertainty.html"><a href="regression-uncertainty.html"><i class="fa fa-check"></i><b>3.3</b> Regression uncertainty</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="regression-uncertainty.html"><a href="regression-uncertainty.html#confidence-intervals"><i class="fa fa-check"></i><b>3.3.1</b> Confidence intervals</a></li>
<li class="chapter" data-level="3.3.2" data-path="regression-uncertainty.html"><a href="regression-uncertainty.html#hypothesis-testing"><i class="fa fa-check"></i><b>3.3.2</b> Hypothesis testing</a></li>
<li class="chapter" data-level="3.3.3" data-path="regression-uncertainty.html"><a href="regression-uncertainty.html#regression-model-uncertainty"><i class="fa fa-check"></i><b>3.3.3</b> Regression model uncertainty</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="dummyVariables.html"><a href="dummyVariables.html"><i class="fa fa-check"></i><b>3.4</b> Regression with categorical variables</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="dummyVariables.html"><a href="dummyVariables.html#categorical-variables-for-the-slope"><i class="fa fa-check"></i><b>3.4.1</b> Categorical variables for the slope</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="likelihoodApproach.html"><a href="likelihoodApproach.html"><i class="fa fa-check"></i><b>3.5</b> Likelihood Approach</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="likelihoodApproach.html"><a href="likelihoodApproach.html#an-example-in-r"><i class="fa fa-check"></i><b>3.5.1</b> An example in R</a></li>
<li class="chapter" data-level="3.5.2" data-path="likelihoodApproach.html"><a href="likelihoodApproach.html#likelihoodApproachMaths"><i class="fa fa-check"></i><b>3.5.2</b> Mathematical explanation</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="statisticsNumberOfParameters.html"><a href="statisticsNumberOfParameters.html"><i class="fa fa-check"></i><b>3.6</b> Calculating number of parameters in models</a></li>
<li class="chapter" data-level="3.7" data-path="assumptions.html"><a href="assumptions.html"><i class="fa fa-check"></i><b>3.7</b> Typical assumptions of statistical models</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="assumptions.html"><a href="assumptions.html#assumptionsCorrectModel"><i class="fa fa-check"></i><b>3.7.1</b> Model is correctly specified</a></li>
<li class="chapter" data-level="3.7.2" data-path="assumptions.html"><a href="assumptions.html#assumptionsResidualsAreIID"><i class="fa fa-check"></i><b>3.7.2</b> Residuals are i.i.d.</a></li>
<li class="chapter" data-level="3.7.3" data-path="assumptions.html"><a href="assumptions.html#assumptionsXreg"><i class="fa fa-check"></i><b>3.7.3</b> The explanatory variables are not correlated with anything but the response variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="regressionModelBuilding.html"><a href="regressionModelBuilding.html"><i class="fa fa-check"></i><b>4</b> Regression model building</a>
<ul>
<li class="chapter" data-level="4.1" data-path="modelSelection.html"><a href="modelSelection.html"><i class="fa fa-check"></i><b>4.1</b> Model selection mechanism</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="modelSelection.html"><a href="modelSelection.html#informationCriteria"><i class="fa fa-check"></i><b>4.1.1</b> Information criteria idea</a></li>
<li class="chapter" data-level="4.1.2" data-path="modelSelection.html"><a href="modelSelection.html#informationCriteriaMistakes"><i class="fa fa-check"></i><b>4.1.2</b> Common confusions related to information criteria</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="forecastingProcess.html"><a href="forecastingProcess.html"><i class="fa fa-check"></i><b>5</b> Forecasts evaluation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="errorMeasures.html"><a href="errorMeasures.html"><i class="fa fa-check"></i><b>5.1</b> Measuring accuracy of point forecasts</a></li>
<li class="chapter" data-level="5.2" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>5.2</b> Measuring uncertainty</a></li>
<li class="chapter" data-level="5.3" data-path="rollingOrigin.html"><a href="rollingOrigin.html"><i class="fa fa-check"></i><b>5.3</b> Rolling origin</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="rollingOrigin.html"><a href="rollingOrigin.html#principles-of-rolling-origin"><i class="fa fa-check"></i><b>5.3.1</b> Principles of Rolling origin</a></li>
<li class="chapter" data-level="5.3.2" data-path="rollingOrigin.html"><a href="rollingOrigin.html#rolling-origin-in-r"><i class="fa fa-check"></i><b>5.3.2</b> Rolling origin in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tsDecomposition.html"><a href="tsDecomposition.html"><i class="fa fa-check"></i><b>6</b> From time series components to ETS</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tsComponents.html"><a href="tsComponents.html"><i class="fa fa-check"></i><b>6.1</b> Time series components</a></li>
<li class="chapter" data-level="6.2" data-path="ClassicalDecomposition.html"><a href="ClassicalDecomposition.html"><i class="fa fa-check"></i><b>6.2</b> Classical Seasonal Decomposition</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ClassicalDecomposition.html"><a href="ClassicalDecomposition.html#how-to-do"><i class="fa fa-check"></i><b>6.2.1</b> How to do?</a></li>
<li class="chapter" data-level="6.2.2" data-path="ClassicalDecomposition.html"><a href="ClassicalDecomposition.html#a-couple-of-examples"><i class="fa fa-check"></i><b>6.2.2</b> A couple of examples</a></li>
<li class="chapter" data-level="6.2.3" data-path="ClassicalDecomposition.html"><a href="ClassicalDecomposition.html#other-techniques"><i class="fa fa-check"></i><b>6.2.3</b> Other techniques</a></li>
<li class="chapter" data-level="6.2.4" data-path="ClassicalDecomposition.html"><a href="ClassicalDecomposition.html#why-bother"><i class="fa fa-check"></i><b>6.2.4</b> “Why bother?”</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ETSTaxonomy.html"><a href="ETSTaxonomy.html"><i class="fa fa-check"></i><b>6.3</b> ETS taxonomy</a></li>
<li class="chapter" data-level="6.4" data-path="ETSTaxonomyMaths.html"><a href="ETSTaxonomyMaths.html"><i class="fa fa-check"></i><b>6.4</b> Mathematical models in the ETS taxonomy</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="conventional-exponential-smoothing.html"><a href="conventional-exponential-smoothing.html"><i class="fa fa-check"></i><b>7</b> Conventional Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="7.1" data-path="SES.html"><a href="SES.html"><i class="fa fa-check"></i><b>7.1</b> Simple Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="SES.html"><a href="SES.html#examples-of-application"><i class="fa fa-check"></i><b>7.1.1</b> Examples of application</a></li>
<li class="chapter" data-level="7.1.2" data-path="SES.html"><a href="SES.html#whyExponential"><i class="fa fa-check"></i><b>7.1.2</b> Why “exponential?”</a></li>
<li class="chapter" data-level="7.1.3" data-path="SES.html"><a href="SES.html#error-correction-form-of-ses"><i class="fa fa-check"></i><b>7.1.3</b> Error correction form of SES</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="SESandETS.html"><a href="SESandETS.html"><i class="fa fa-check"></i><b>7.2</b> SES and ETS</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="SESandETS.html"><a href="SESandETS.html#etsann"><i class="fa fa-check"></i><b>7.2.1</b> ETS(A,N,N)</a></li>
<li class="chapter" data-level="7.2.2" data-path="SESandETS.html"><a href="SESandETS.html#etsmnn"><i class="fa fa-check"></i><b>7.2.2</b> ETS(M,N,N)</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ETSExamples.html"><a href="ETSExamples.html"><i class="fa fa-check"></i><b>7.3</b> Several examples of exponential smoothing methods and ETS</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ETSExamples.html"><a href="ETSExamples.html#ETSAAN"><i class="fa fa-check"></i><b>7.3.1</b> ETS(A,A,N)</a></li>
<li class="chapter" data-level="7.3.2" data-path="ETSExamples.html"><a href="ETSExamples.html#ETSAAdN"><i class="fa fa-check"></i><b>7.3.2</b> ETS(A,Ad,N)</a></li>
<li class="chapter" data-level="7.3.3" data-path="ETSExamples.html"><a href="ETSExamples.html#etsaam"><i class="fa fa-check"></i><b>7.3.3</b> ETS(A,A,M)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ets-assumptions-estimation-and-selection.html"><a href="ets-assumptions-estimation-and-selection.html"><i class="fa fa-check"></i><b>7.4</b> ETS assumptions, estimation and selection</a></li>
<li class="chapter" data-level="7.5" data-path="state-space-form-of-ets.html"><a href="state-space-form-of-ets.html"><i class="fa fa-check"></i><b>7.5</b> State space form of ETS</a></li>
<li class="chapter" data-level="7.6" data-path="ETSParametersBounds.html"><a href="ETSParametersBounds.html"><i class="fa fa-check"></i><b>7.6</b> Parameters bounds</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ADAMETSIntroduction.html"><a href="ADAMETSIntroduction.html"><i class="fa fa-check"></i><b>8</b> Pure additive ADAM ETS</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ADAMETSPureAdditive.html"><a href="ADAMETSPureAdditive.html"><i class="fa fa-check"></i><b>8.1</b> Model formulation</a></li>
<li class="chapter" data-level="8.2" data-path="adamETSPureAdditiveRecursive.html"><a href="adamETSPureAdditiveRecursive.html"><i class="fa fa-check"></i><b>8.2</b> Recursive relation</a></li>
<li class="chapter" data-level="8.3" data-path="pureAdditiveExpectationAndVariance.html"><a href="pureAdditiveExpectationAndVariance.html"><i class="fa fa-check"></i><b>8.3</b> Conditional expectation and variance</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="pureAdditiveExpectationAndVariance.html"><a href="pureAdditiveExpectationAndVariance.html#example-with-etsann"><i class="fa fa-check"></i><b>8.3.1</b> Example with ETS(A,N,N)</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="stabilityConditionAdditiveError.html"><a href="stabilityConditionAdditiveError.html"><i class="fa fa-check"></i><b>8.4</b> Stability and forecastability conditions</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="stabilityConditionAdditiveError.html"><a href="stabilityConditionAdditiveError.html#example-with-etsann-1"><i class="fa fa-check"></i><b>8.4.1</b> Example with ETS(A,N,N)</a></li>
<li class="chapter" data-level="8.4.2" data-path="stabilityConditionAdditiveError.html"><a href="stabilityConditionAdditiveError.html#comming-back-to-the-general-case"><i class="fa fa-check"></i><b>8.4.2</b> Comming back to the general case</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ADAMETSAdditiveDistributions.html"><a href="ADAMETSAdditiveDistributions.html"><i class="fa fa-check"></i><b>8.5</b> Distributional assumptions in pure additive ETS</a></li>
<li class="chapter" data-level="8.6" data-path="ADAMETSPureAdditiveExamples.html"><a href="ADAMETSPureAdditiveExamples.html"><i class="fa fa-check"></i><b>8.6</b> Examples of application</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="ADAMETSPureAdditiveExamples.html"><a href="ADAMETSPureAdditiveExamples.html#non-seasonal-data"><i class="fa fa-check"></i><b>8.6.1</b> Non-seasonal data</a></li>
<li class="chapter" data-level="8.6.2" data-path="ADAMETSPureAdditiveExamples.html"><a href="ADAMETSPureAdditiveExamples.html#ADAMETSPureAdditiveExamplesETSAAA"><i class="fa fa-check"></i><b>8.6.2</b> Seasonal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ADAMETSPureMultiplicative.html"><a href="ADAMETSPureMultiplicative.html"><i class="fa fa-check"></i><b>9</b> Pure multiplicative ADAM ETS</a>
<ul>
<li class="chapter" data-level="9.1" data-path="adamETSPuremultiplicativeRecursive.html"><a href="adamETSPuremultiplicativeRecursive.html"><i class="fa fa-check"></i><b>9.1</b> Recursive relation</a></li>
<li class="chapter" data-level="9.2" data-path="pureMultiplicativeExpectationAndVariance.html"><a href="pureMultiplicativeExpectationAndVariance.html"><i class="fa fa-check"></i><b>9.2</b> The problem with moments in pure multiplicative ETS</a></li>
<li class="chapter" data-level="9.3" data-path="stabilityConditionMultiplicativeError.html"><a href="stabilityConditionMultiplicativeError.html"><i class="fa fa-check"></i><b>9.3</b> Smoothing parameters bounds</a></li>
<li class="chapter" data-level="9.4" data-path="ADAMETSMultiplicativeDistributions.html"><a href="ADAMETSMultiplicativeDistributions.html"><i class="fa fa-check"></i><b>9.4</b> Distributional assumptions in pure multiplicative ETS</a></li>
<li class="chapter" data-level="9.5" data-path="ADAMETSMultiplicativeExamples.html"><a href="ADAMETSMultiplicativeExamples.html"><i class="fa fa-check"></i><b>9.5</b> Examples of application</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="ADAMETSMultiplicativeExamples.html"><a href="ADAMETSMultiplicativeExamples.html#non-seasonal-data-1"><i class="fa fa-check"></i><b>9.5.1</b> Non-seasonal data</a></li>
<li class="chapter" data-level="9.5.2" data-path="ADAMETSMultiplicativeExamples.html"><a href="ADAMETSMultiplicativeExamples.html#seasonal-data"><i class="fa fa-check"></i><b>9.5.2</b> Seasonal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ADAMETSMixedModels.html"><a href="ADAMETSMixedModels.html"><i class="fa fa-check"></i><b>10</b> Further ADAM ETS topics</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ADAMETSMixedModelsGroup3.html"><a href="ADAMETSMixedModelsGroup3.html"><i class="fa fa-check"></i><b>10.1</b> Mixed models with non-multiplicative trend</a></li>
<li class="chapter" data-level="10.2" data-path="ADAMETSMixedModelsGroup4.html"><a href="ADAMETSMixedModelsGroup4.html"><i class="fa fa-check"></i><b>10.2</b> Mixed models with multiplicative trend</a></li>
<li class="chapter" data-level="10.3" data-path="ADAMETSSeasonalNormalisation.html"><a href="ADAMETSSeasonalNormalisation.html"><i class="fa fa-check"></i><b>10.3</b> Normalisation of seasonal indices in ETS models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ARIMA.html"><a href="ARIMA.html"><i class="fa fa-check"></i><b>11</b> Conventional ARIMA</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html"><i class="fa fa-check"></i><b>11.1</b> Introduction to ARIMA</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#AR"><i class="fa fa-check"></i><b>11.1.1</b> AR(p)</a></li>
<li class="chapter" data-level="11.1.2" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#MA"><i class="fa fa-check"></i><b>11.1.2</b> MA(q)</a></li>
<li class="chapter" data-level="11.1.3" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#ARMA"><i class="fa fa-check"></i><b>11.1.3</b> ARMA(p,q)</a></li>
<li class="chapter" data-level="11.1.4" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#ARMAConstant"><i class="fa fa-check"></i><b>11.1.4</b> ARMA with constant</a></li>
<li class="chapter" data-level="11.1.5" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#Differences"><i class="fa fa-check"></i><b>11.1.5</b> I(d)</a></li>
<li class="chapter" data-level="11.1.6" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#arimapdq"><i class="fa fa-check"></i><b>11.1.6</b> ARIMA(p,d,q)</a></li>
<li class="chapter" data-level="11.1.7" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#ARIMABounds"><i class="fa fa-check"></i><b>11.1.7</b> Parameters bounds</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="seasonal-arima.html"><a href="seasonal-arima.html"><i class="fa fa-check"></i><b>11.2</b> Seasonal ARIMA</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="seasonal-arima.html"><a href="seasonal-arima.html#single-seasonal-arima"><i class="fa fa-check"></i><b>11.2.1</b> Single seasonal ARIMA</a></li>
<li class="chapter" data-level="11.2.2" data-path="seasonal-arima.html"><a href="seasonal-arima.html#sarima-with-constant"><i class="fa fa-check"></i><b>11.2.2</b> SARIMA with constant</a></li>
<li class="chapter" data-level="11.2.3" data-path="seasonal-arima.html"><a href="seasonal-arima.html#MSARIMA"><i class="fa fa-check"></i><b>11.2.3</b> Multiple seasonal ARIMA</a></li>
<li class="chapter" data-level="11.2.4" data-path="seasonal-arima.html"><a href="seasonal-arima.html#MSARIMABounds"><i class="fa fa-check"></i><b>11.2.4</b> Parameters bounds for MSARIMA</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="BJApproach.html"><a href="BJApproach.html"><i class="fa fa-check"></i><b>11.3</b> Box-Jenkins approach</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="BJApproach.html"><a href="BJApproach.html#identifying-stationarity"><i class="fa fa-check"></i><b>11.3.1</b> Identifying stationarity</a></li>
<li class="chapter" data-level="11.3.2" data-path="BJApproach.html"><a href="BJApproach.html#ACF"><i class="fa fa-check"></i><b>11.3.2</b> Autocorrelation function (ACF)</a></li>
<li class="chapter" data-level="11.3.3" data-path="BJApproach.html"><a href="BJApproach.html#PACF"><i class="fa fa-check"></i><b>11.3.3</b> Partial autocorrelation function (PACF)</a></li>
<li class="chapter" data-level="11.3.4" data-path="BJApproach.html"><a href="BJApproach.html#BJApproachSummary"><i class="fa fa-check"></i><b>11.3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html"><i class="fa fa-check"></i><b>11.4</b> ARIMA and ETS</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html#ARIMAETS011"><i class="fa fa-check"></i><b>11.4.1</b> ARIMA(0,1,1) and ETS(A,N,N)</a></li>
<li class="chapter" data-level="11.4.2" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html#ARIMAETS022"><i class="fa fa-check"></i><b>11.4.2</b> ARIMA(0,2,2) and ETS(A,A,N)</a></li>
<li class="chapter" data-level="11.4.3" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html#ARIMAETS112"><i class="fa fa-check"></i><b>11.4.3</b> ARIMA(1,1,2) and ETS(A,Ad,N)</a></li>
<li class="chapter" data-level="11.4.4" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html#arima-and-other-ets-models"><i class="fa fa-check"></i><b>11.4.4</b> ARIMA and other ETS models</a></li>
<li class="chapter" data-level="11.4.5" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html#ets-arima"><i class="fa fa-check"></i><b>11.4.5</b> ETS + ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="ARIMAExampleInR.html"><a href="ARIMAExampleInR.html"><i class="fa fa-check"></i><b>11.5</b> Examples of application</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="ARIMAExampleInR.html"><a href="ARIMAExampleInR.html#non-seasonal-data-2"><i class="fa fa-check"></i><b>11.5.1</b> Non-seasonal data</a></li>
<li class="chapter" data-level="11.5.2" data-path="ARIMAExampleInR.html"><a href="ARIMAExampleInR.html#ARIMAExampleInRSeasonal"><i class="fa fa-check"></i><b>11.5.2</b> Seasonal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ADAMARIMA.html"><a href="ADAMARIMA.html"><i class="fa fa-check"></i><b>12</b> ADAM ARIMA</a>
<ul>
<li class="chapter" data-level="12.1" data-path="StateSpaceARIMA.html"><a href="StateSpaceARIMA.html"><i class="fa fa-check"></i><b>12.1</b> State space ARIMA</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="StateSpaceARIMA.html"><a href="StateSpaceARIMA.html#StateSpaceARIMAAdditive"><i class="fa fa-check"></i><b>12.1.1</b> Additive ARIMA</a></li>
<li class="chapter" data-level="12.1.2" data-path="StateSpaceARIMA.html"><a href="StateSpaceARIMA.html#an-example"><i class="fa fa-check"></i><b>12.1.2</b> An example</a></li>
<li class="chapter" data-level="12.1.3" data-path="StateSpaceARIMA.html"><a href="StateSpaceARIMA.html#state-space-arima-with-constant"><i class="fa fa-check"></i><b>12.1.3</b> State space ARIMA with constant</a></li>
<li class="chapter" data-level="12.1.4" data-path="StateSpaceARIMA.html"><a href="StateSpaceARIMA.html#ADAMARIMAPureMultiplicative"><i class="fa fa-check"></i><b>12.1.4</b> Multiplicative ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="ADAMARIMARecursive.html"><a href="ADAMARIMARecursive.html"><i class="fa fa-check"></i><b>12.2</b> Recursive relation</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ADAMARIMARecursive.html"><a href="ADAMARIMARecursive.html#moments-of-adam-arima"><i class="fa fa-check"></i><b>12.2.1</b> Moments of ADAM ARIMA</a></li>
<li class="chapter" data-level="12.2.2" data-path="ADAMARIMARecursive.html"><a href="ADAMARIMARecursive.html#parameters-bounds"><i class="fa fa-check"></i><b>12.2.2</b> Parameters bounds</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ADAMARIMADistributions.html"><a href="ADAMARIMADistributions.html"><i class="fa fa-check"></i><b>12.3</b> Distributional assumptions of ADAM ARIMA</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ADAMARIMADistributions.html"><a href="ADAMARIMADistributions.html#conditional-distributions"><i class="fa fa-check"></i><b>12.3.1</b> Conditional distributions</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ets-arima-1.html"><a href="ets-arima-1.html"><i class="fa fa-check"></i><b>12.4</b> ETS + ARIMA</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="ets-arima-1.html"><a href="ets-arima-1.html#pure-additive-models"><i class="fa fa-check"></i><b>12.4.1</b> Pure additive models</a></li>
<li class="chapter" data-level="12.4.2" data-path="ets-arima-1.html"><a href="ets-arima-1.html#pure-multiplicative-models"><i class="fa fa-check"></i><b>12.4.2</b> Pure multiplicative models</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="ADAMARIMAExamples.html"><a href="ADAMARIMAExamples.html"><i class="fa fa-check"></i><b>12.5</b> Examples of application</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ADAMX.html"><a href="ADAMX.html"><i class="fa fa-check"></i><b>13</b> Explanatory variables in ADAM</a>
<ul>
<li class="chapter" data-level="13.1" data-path="adamx-model-formulation.html"><a href="adamx-model-formulation.html"><i class="fa fa-check"></i><b>13.1</b> ADAMX: Model formulation</a></li>
<li class="chapter" data-level="13.2" data-path="ADAMXConventionalConditionalMoments.html"><a href="ADAMXConventionalConditionalMoments.html"><i class="fa fa-check"></i><b>13.2</b> Conditional expectation and variance of ADAMX</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ADAMXConventionalConditionalMoments.html"><a href="ADAMXConventionalConditionalMoments.html#the-adamx-with-known-explanatory-variables"><i class="fa fa-check"></i><b>13.2.1</b> The ADAMX with known explanatory variables</a></li>
<li class="chapter" data-level="13.2.2" data-path="ADAMXConventionalConditionalMoments.html"><a href="ADAMXConventionalConditionalMoments.html#adamx-with-random-explanatory-variables"><i class="fa fa-check"></i><b>13.2.2</b> ADAMX with random explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ADAMXDynamic.html"><a href="ADAMXDynamic.html"><i class="fa fa-check"></i><b>13.3</b> Dynamic X in ADAMX</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ADAMXDynamic.html"><a href="ADAMXDynamic.html#conditional-moments-of-dynamic-adamx"><i class="fa fa-check"></i><b>13.3.1</b> Conditional moments of dynamic ADAMX</a></li>
<li class="chapter" data-level="13.3.2" data-path="ADAMXDynamic.html"><a href="ADAMXDynamic.html#known-explanatory-variables"><i class="fa fa-check"></i><b>13.3.2</b> Known explanatory variables</a></li>
<li class="chapter" data-level="13.3.3" data-path="ADAMXDynamic.html"><a href="ADAMXDynamic.html#random-explanatory-variables"><i class="fa fa-check"></i><b>13.3.3</b> Random explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="stability-and-forecastability-conditions-of-adamx.html"><a href="stability-and-forecastability-conditions-of-adamx.html"><i class="fa fa-check"></i><b>13.4</b> Stability and forecastability conditions of ADAMX</a></li>
<li class="chapter" data-level="13.5" data-path="ETSXDynamicCategories.html"><a href="ETSXDynamicCategories.html"><i class="fa fa-check"></i><b>13.5</b> Dealing with categorical variables in ADAMX</a></li>
<li class="chapter" data-level="13.6" data-path="ETSXRExample.html"><a href="ETSXRExample.html"><i class="fa fa-check"></i><b>13.6</b> Examples of application</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ADAMETSEstimation.html"><a href="ADAMETSEstimation.html"><i class="fa fa-check"></i><b>14</b> Estimation of ADAM models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ADAMETSEstimationLikelihood.html"><a href="ADAMETSEstimationLikelihood.html"><i class="fa fa-check"></i><b>14.1</b> Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="ADAMETSEstimationLikelihood.html"><a href="ADAMETSEstimationLikelihood.html#an-example-in-r-1"><i class="fa fa-check"></i><b>14.1.1</b> An example in R</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html"><i class="fa fa-check"></i><b>14.2</b> Non MLE-based loss functions</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html#MSEandMAEEstimators"><i class="fa fa-check"></i><b>14.2.1</b> MSE and MAE</a></li>
<li class="chapter" data-level="14.2.2" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html#ham"><i class="fa fa-check"></i><b>14.2.2</b> HAM</a></li>
<li class="chapter" data-level="14.2.3" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html#lasso-and-ridge"><i class="fa fa-check"></i><b>14.2.3</b> LASSO and RIDGE</a></li>
<li class="chapter" data-level="14.2.4" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html#custom-losses"><i class="fa fa-check"></i><b>14.2.4</b> Custom losses</a></li>
<li class="chapter" data-level="14.2.5" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html#examples-in-r"><i class="fa fa-check"></i><b>14.2.5</b> Examples in R</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="multistepLosses.html"><a href="multistepLosses.html"><i class="fa fa-check"></i><b>14.3</b> Multistep losses</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="multistepLosses.html"><a href="multistepLosses.html#mathrmmse_h---mse-for-h-steps-ahead"><i class="fa fa-check"></i><b>14.3.1</b> <span class="math inline">\(\mathrm{MSE}_h\)</span> - MSE for h steps ahead</a></li>
<li class="chapter" data-level="14.3.2" data-path="multistepLosses.html"><a href="multistepLosses.html#multistepLossesTMSE"><i class="fa fa-check"></i><b>14.3.2</b> TMSE - Trace MSE</a></li>
<li class="chapter" data-level="14.3.3" data-path="multistepLosses.html"><a href="multistepLosses.html#multistepLossesGTMSE"><i class="fa fa-check"></i><b>14.3.3</b> GTMSE - Geometric Trace MSE</a></li>
<li class="chapter" data-level="14.3.4" data-path="multistepLosses.html"><a href="multistepLosses.html#msce---mean-squared-cumulative-error"><i class="fa fa-check"></i><b>14.3.4</b> MSCE - Mean Squared Cumulative Error</a></li>
<li class="chapter" data-level="14.3.5" data-path="multistepLosses.html"><a href="multistepLosses.html#gpl---general-predictive-likelihood"><i class="fa fa-check"></i><b>14.3.5</b> GPL - General Predictive Likelihood</a></li>
<li class="chapter" data-level="14.3.6" data-path="multistepLosses.html"><a href="multistepLosses.html#other-multistep-estimators"><i class="fa fa-check"></i><b>14.3.6</b> Other multistep estimators</a></li>
<li class="chapter" data-level="14.3.7" data-path="multistepLosses.html"><a href="multistepLosses.html#an-example-in-r-2"><i class="fa fa-check"></i><b>14.3.7</b> An example in R</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html"><i class="fa fa-check"></i><b>14.4</b> Initialisation of ADAM</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html#ADAMInitialisationOptAndBack"><i class="fa fa-check"></i><b>14.4.1</b> Optimisation vs backcasting</a></li>
<li class="chapter" data-level="14.4.2" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html#pre-initialisation-of-adam-parameters"><i class="fa fa-check"></i><b>14.4.2</b> Pre-initialisation of ADAM parameters</a></li>
<li class="chapter" data-level="14.4.3" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html#pre-initialisation-of-adam-states-ets"><i class="fa fa-check"></i><b>14.4.3</b> Pre-initialisation of ADAM states, ETS</a></li>
<li class="chapter" data-level="14.4.4" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html#pre-initialisation-of-adam-states-arima"><i class="fa fa-check"></i><b>14.4.4</b> Pre-initialisation of ADAM states, ARIMA</a></li>
<li class="chapter" data-level="14.4.5" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html#pre-initialisation-of-adam-states-regressors-and-constant"><i class="fa fa-check"></i><b>14.4.5</b> Pre-initialisation of ADAM states, Regressors and constant</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="multiple-frequencies-in-adam-ets.html"><a href="multiple-frequencies-in-adam-ets.html"><i class="fa fa-check"></i><b>15</b> Multiple frequencies in ADAM ETS</a>
<ul>
<li class="chapter" data-level="15.1" data-path="estimation-of-multiple-seasonal-model.html"><a href="estimation-of-multiple-seasonal-model.html"><i class="fa fa-check"></i><b>15.1</b> Estimation of multiple seasonal model</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="estimation-of-multiple-seasonal-model.html"><a href="estimation-of-multiple-seasonal-model.html#adam-ets-issues"><i class="fa fa-check"></i><b>15.1.1</b> ADAM ETS issues</a></li>
<li class="chapter" data-level="15.1.2" data-path="estimation-of-multiple-seasonal-model.html"><a href="estimation-of-multiple-seasonal-model.html#adam-arima-issues"><i class="fa fa-check"></i><b>15.1.2</b> ADAM ARIMA issues</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="ETSXMultipleSeasonality.html"><a href="ETSXMultipleSeasonality.html"><i class="fa fa-check"></i><b>15.2</b> Using explanatory variables for multiple seasonalities</a></li>
<li class="chapter" data-level="15.3" data-path="MultipleFrequenciesDSTandLeap.html"><a href="MultipleFrequenciesDSTandLeap.html"><i class="fa fa-check"></i><b>15.3</b> Dealing with daylight saving and leap years</a></li>
<li class="chapter" data-level="15.4" data-path="ADAMMultipleFrequenciesExamples.html"><a href="ADAMMultipleFrequenciesExamples.html"><i class="fa fa-check"></i><b>15.4</b> Examples of application</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="ADAMMultipleFrequenciesExamples.html"><a href="ADAMMultipleFrequenciesExamples.html#adam-ets"><i class="fa fa-check"></i><b>15.4.1</b> ADAM ETS</a></li>
<li class="chapter" data-level="15.4.2" data-path="ADAMMultipleFrequenciesExamples.html"><a href="ADAMMultipleFrequenciesExamples.html#adam-etsx"><i class="fa fa-check"></i><b>15.4.2</b> ADAM ETSX</a></li>
<li class="chapter" data-level="15.4.3" data-path="ADAMMultipleFrequenciesExamples.html"><a href="ADAMMultipleFrequenciesExamples.html#adam-arima"><i class="fa fa-check"></i><b>15.4.3</b> ADAM ARIMA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ADAMIntermittent.html"><a href="ADAMIntermittent.html"><i class="fa fa-check"></i><b>16</b> ADAM for Intermittent Demand</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html"><i class="fa fa-check"></i><b>16.1</b> Occurrence part of the model</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#fixed-probability-model-oets_f"><i class="fa fa-check"></i><b>16.1.1</b> Fixed probability model, oETS<span class="math inline">\(_F\)</span></a></li>
<li class="chapter" data-level="16.1.2" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#oETSO"><i class="fa fa-check"></i><b>16.1.2</b> Odds ratio model, oETS<span class="math inline">\(_O\)</span></a></li>
<li class="chapter" data-level="16.1.3" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#inverse-odds-ratio-model-oets_i"><i class="fa fa-check"></i><b>16.1.3</b> Inverse odds ratio model, oETS<span class="math inline">\(_I\)</span></a></li>
<li class="chapter" data-level="16.1.4" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#oETSG"><i class="fa fa-check"></i><b>16.1.4</b> General oETS model, oETS<span class="math inline">\(_G\)</span></a></li>
<li class="chapter" data-level="16.1.5" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#direct-probability-model-oets_d"><i class="fa fa-check"></i><b>16.1.5</b> Direct probability model, oETS<span class="math inline">\(_D\)</span></a></li>
<li class="chapter" data-level="16.1.6" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#oETSModelSelection"><i class="fa fa-check"></i><b>16.1.6</b> Model selection in oETS</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="ADAMDemandSizes.html"><a href="ADAMDemandSizes.html"><i class="fa fa-check"></i><b>16.2</b> Demand sizes part of the model</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="ADAMDemandSizes.html"><a href="ADAMDemandSizes.html#additive-vs-multiplicative-ets-for-demand-sizes"><i class="fa fa-check"></i><b>16.2.1</b> Additive vs multiplicative ETS for demand sizes</a></li>
<li class="chapter" data-level="16.2.2" data-path="ADAMDemandSizes.html"><a href="ADAMDemandSizes.html#using-arima-for-demand-sizes"><i class="fa fa-check"></i><b>16.2.2</b> Using ARIMA for demand sizes</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="ADAMIntermittentFull.html"><a href="ADAMIntermittentFull.html"><i class="fa fa-check"></i><b>16.3</b> The full ADAM model</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="ADAMIntermittentFull.html"><a href="ADAMIntermittentFull.html#iETSMLE"><i class="fa fa-check"></i><b>16.3.1</b> Maximum Likelihood Estimation</a></li>
<li class="chapter" data-level="16.3.2" data-path="ADAMIntermittentFull.html"><a href="ADAMIntermittentFull.html#conditional-expectation-and-variance"><i class="fa fa-check"></i><b>16.3.2</b> Conditional expectation and variance</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="examples-of-application-1.html"><a href="examples-of-application-1.html"><i class="fa fa-check"></i><b>16.4</b> Examples of application</a></li>
<li class="chapter" data-level="16.5" data-path="intermittent-demand-challenges.html"><a href="intermittent-demand-challenges.html"><i class="fa fa-check"></i><b>16.5</b> Intermittent demand challenges</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>17</b> Model diagnostics</a>
<ul>
<li class="chapter" data-level="17.1" data-path="diagnosticsOmitted.html"><a href="diagnosticsOmitted.html"><i class="fa fa-check"></i><b>17.1</b> Model specification: Omitted variables</a></li>
<li class="chapter" data-level="17.2" data-path="model-specification-redundant-variables.html"><a href="model-specification-redundant-variables.html"><i class="fa fa-check"></i><b>17.2</b> Model specification: Redundant variables</a></li>
<li class="chapter" data-level="17.3" data-path="diagnosticsTransformations.html"><a href="diagnosticsTransformations.html"><i class="fa fa-check"></i><b>17.3</b> Model specification: Transformations</a></li>
<li class="chapter" data-level="17.4" data-path="diagnosticsOutliers.html"><a href="diagnosticsOutliers.html"><i class="fa fa-check"></i><b>17.4</b> Model specification: Outliers</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="diagnosticsOutliers.html"><a href="diagnosticsOutliers.html#outliers-detection"><i class="fa fa-check"></i><b>17.4.1</b> Outliers detection</a></li>
<li class="chapter" data-level="17.4.2" data-path="diagnosticsOutliers.html"><a href="diagnosticsOutliers.html#dealing-with-outliers"><i class="fa fa-check"></i><b>17.4.2</b> Dealing with outliers</a></li>
<li class="chapter" data-level="17.4.3" data-path="diagnosticsOutliers.html"><a href="diagnosticsOutliers.html#an-automatic-mechanism"><i class="fa fa-check"></i><b>17.4.3</b> An automatic mechanism</a></li>
<li class="chapter" data-level="17.4.4" data-path="diagnosticsOutliers.html"><a href="diagnosticsOutliers.html#final-remarks"><i class="fa fa-check"></i><b>17.4.4</b> Final remarks</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="diagnosticsResidualsIIDAuto.html"><a href="diagnosticsResidualsIIDAuto.html"><i class="fa fa-check"></i><b>17.5</b> Residuals are i.i.d.: autocorrelation</a></li>
<li class="chapter" data-level="17.6" data-path="diagnosticsResidualsIIDHetero.html"><a href="diagnosticsResidualsIIDHetero.html"><i class="fa fa-check"></i><b>17.6</b> Residuals are i.i.d.: heteroscedasticity</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="diagnosticsResidualsIIDHetero.html"><a href="diagnosticsResidualsIIDHetero.html#detecting-heteroscedasticity"><i class="fa fa-check"></i><b>17.6.1</b> Detecting heteroscedasticity</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="residuals-are-i-i-d-zero-expectation.html"><a href="residuals-are-i-i-d-zero-expectation.html"><i class="fa fa-check"></i><b>17.7</b> Residuals are i.i.d.: zero expectation</a></li>
<li class="chapter" data-level="17.8" data-path="residuals-are-i-i-d-distributional-assumptions.html"><a href="residuals-are-i-i-d-distributional-assumptions.html"><i class="fa fa-check"></i><b>17.8</b> Residuals are i.i.d.: distributional assumptions</a></li>
<li class="chapter" data-level="17.9" data-path="multicollinearity.html"><a href="multicollinearity.html"><i class="fa fa-check"></i><b>17.9</b> Multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="ADAMSelection.html"><a href="ADAMSelection.html"><i class="fa fa-check"></i><b>18</b> Model selection and combinations in ADAM</a>
<ul>
<li class="chapter" data-level="18.1" data-path="ETSSelection.html"><a href="ETSSelection.html"><i class="fa fa-check"></i><b>18.1</b> ADAM ETS components selection</a></li>
<li class="chapter" data-level="18.2" data-path="ARIMASelection.html"><a href="ARIMASelection.html"><i class="fa fa-check"></i><b>18.2</b> ADAM ARIMA order selection</a></li>
<li class="chapter" data-level="18.3" data-path="ETSXSelection.html"><a href="ETSXSelection.html"><i class="fa fa-check"></i><b>18.3</b> Explanatory variables selection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting and Analytics with ADAM</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b><a href="open.html#open">Open Review</a></b>. I want your feedback to make the book better for you and other readers. To add your annotation, <span style="background-color: #3297FD; color: white">select some text</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. To see the annotations of others, click the button in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="correlations" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Correlation and measures of association</h2>
<p>Now that we have discussed confidence intervals and hypothesis testing, we can move towards the analysis of relations between variables, in a way continuing the preliminary data analysis that we finished in Section <a href="dataAnalysis.html#dataAnalysis">2.1</a>. We continue using the same dataset <code>mtcarsData</code> with the two categorical variables, <code>am</code> and <code>vs</code>.</p>
<div id="nominal-scale-1" class="section level3" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Nominal scale</h3>
<p>As discussed in Section <a href="scales.html#scales">1.2</a>, not all scales support the more advanced operations (such as taking mean in ordinal scale). This means that if we want to analyse relations between variables, we need to use appropriate instrument. The coefficients that show relations between variables are called “<strong>measures of association</strong>.” We start their discussions with the simplest scale - nominal.</p>
<p>There are several measures of association for the variables in nominal scale. They are all based on calculating the number of specific values of variables, but use different formulae. The first one is called <strong>contingency coefficient <span class="math inline">\(\phi\)</span></strong> and can only be calculated between variables that have only two values. As the name says, this measure is based on the contingency table. Here is an example:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="correlations.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mtcarsData<span class="sc">$</span>vs,mtcarsData<span class="sc">$</span>am)</span></code></pre></div>
<pre><code>##           
##            automatic manual
##   V-shaped        12      6
##   Straight         7      7</code></pre>
<p>The <span class="math inline">\(\phi\)</span> coefficient is calculated as:
<span class="math display" id="eq:measuresAssociationPhi">\[\begin{equation}
    \phi = \frac{n_{1,1} n_{2,2} - n_{1,2} n_{2,1}}{\sqrt{n_{1,\cdot}\times n_{2,\cdot}\times n_{\cdot,1}\times n_{\cdot,2}}} ,
    \tag{2.7}
\end{equation}\]</span>
where <span class="math inline">\(n_{i,j}\)</span> is the element of the table on row <span class="math inline">\(i\)</span> and column <span class="math inline">\(j\)</span>, <span class="math inline">\(n_{i,\cdot}=\sum_{j}n_{i,j}\)</span> - is the sum in row <span class="math inline">\(i\)</span> and <span class="math inline">\(n_{\cdot,j}=\sum_{i} n_{i,j}\)</span> - is the sum in column <span class="math inline">\(j\)</span>. This coefficient lies between -1 and 1 and has a simple interpretation: if will be close to 1, when the elements on diagonal are greater than the off-diagonal ones, implying that there is a relation between variables. The value of -1 can only be obtained, when off-diagonal elements are non-zero, while the diagonal ones are zero. Finally, if the values in the contingency table are distributed evenly, the coefficient will be equal to zero. In our case the value of <span class="math inline">\(\phi\)</span> is:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="correlations.html#cb53-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">12</span><span class="sc">*</span><span class="dv">7</span> <span class="sc">-</span> <span class="dv">6</span><span class="sc">*</span><span class="dv">7</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">19</span><span class="sc">*</span><span class="dv">13</span><span class="sc">*</span><span class="dv">14</span><span class="sc">*</span><span class="dv">18</span>)</span></code></pre></div>
<pre><code>## [1] 0.1683451</code></pre>
<p>This is a very low value, so even if the two variables are related, the relation is not well pronounced. In order to see, whether this value is statistically significantly different from zero, we could test a statistical hypothesis (hypothesis testing was discussed in Section <a href="hypothesisTesting.html#hypothesisTesting">2.5</a>):</p>
<p><span class="math inline">\(H_0\)</span>: there is no relation between variables</p>
<p><span class="math inline">\(H_1\)</span>: there is some relation between variables</p>
<p>This can be done using <strong><span class="math inline">\(\chi^2\)</span> test</strong>, the statistics for which is calculated via:
<span class="math display" id="eq:measuresAssociationChi">\[\begin{equation}
    \chi^2 = \sum_{i,j} \frac{n \times n_{i,j} - n_{i,\cdot} \times n_{\cdot,j}}{n \times n_{i,\cdot} \times n_{\cdot,j}} ,
    \tag{2.8}
\end{equation}\]</span>
where <span class="math inline">\(n\)</span> is the sum of elements in the contingency table. The value calculated based on <a href="correlations.html#eq:measuresAssociationChi">(2.8)</a> will follow <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\((r-1)(c-1)\)</span> degrees of freedom, where <span class="math inline">\(r\)</span> is the number of rows and <span class="math inline">\(c\)</span> is the number of columns in contingency table. This is a proper statistical test, so it should be treated as one. We select my favourite significance level, 1% and can now conduct the test:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="correlations.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="fu">table</span>(mtcarsData<span class="sc">$</span>vs,mtcarsData<span class="sc">$</span>am))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  table(mtcarsData$vs, mtcarsData$am)
## X-squared = 0.34754, df = 1, p-value = 0.5555</code></pre>
<p>Given that p-value is greater than 1%, we fail to reject the null hypothesis and can conclude that the relation does not seem to be different from zero - we do not find a relation between the variables in our data.</p>
<p>The main limitation of the coefficient <span class="math inline">\(\phi\)</span> is that it only works for the <span class="math inline">\(2\times 2\)</span> tables. In reality we can have variables in nominal scale that take several values and it might be useful to know relations between them. For example, we can have a variable <code>colour</code>, which takes values <code>red</code>, <code>green</code> and <code>blue</code> and we would want to know if it is related to the transmission type. We do not have this variable in the data, so just for this example, we will create one (using multinomial distribution):</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="correlations.html#cb57-1" aria-hidden="true" tabindex="-1"></a>colour <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%*%</span> <span class="fu">rmultinom</span>(<span class="fu">nrow</span>(mtcars), <span class="dv">1</span>,</span>
<span id="cb57-2"><a href="correlations.html#cb57-2" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>))</span>
<span id="cb57-3"><a href="correlations.html#cb57-3" aria-hidden="true" tabindex="-1"></a>colour <span class="ot">&lt;-</span> <span class="fu">factor</span>(colour, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb57-4"><a href="correlations.html#cb57-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;blue&quot;</span>))</span>
<span id="cb57-5"><a href="correlations.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(colour), <span class="at">xlab=</span><span class="st">&quot;Colour&quot;</span>)</span></code></pre></div>
<p>In order to measure relation between the new variable and the <code>am</code>, we can use Cramer’s V coefficient, which relies on the formula of <span class="math inline">\(\chi^2\)</span> test <a href="correlations.html#eq:measuresAssociationChi">(2.8)</a>:
<span class="math display" id="eq:measuresAssociationCramer">\[\begin{equation}
    V = \sqrt{\frac{\chi^2}{n\times \min(r-1, c-1)}} .
    \tag{2.9}
\end{equation}\]</span></p>
<p>Cramer’s V always lies between 0 and 1, becoming close to one only if there is some relation between the two categorical variables. <code>greybox</code> package implements this coefficient in <code>cramer()</code> function:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="correlations.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cramer</span>(mtcarsData<span class="sc">$</span>am,colour)</span></code></pre></div>
<pre><code>## Cramer&#39;s V: 0.1003
## Chi^2 statistics = 0.3222, df: 2, p-value: 0.8512</code></pre>
<p>The output above shows that the value of the coefficient is approximately 0.1, which is low, implying that the relation between the two variables is very weak. In addition, the p-value tells us that we fail to reject the null hypothesis on 1% level in the <span class="math inline">\(\chi^2\)</span> test <a href="correlations.html#eq:measuresAssociationChi">(2.8)</a>, and the relation does not look statistically significant. So we can conclude that according to our data, the two variables are not related (no wonder, we have generated one of them).</p>
<p>The main limitation of Cramer’s V is that it is difficult to interpret beyond “there is a relation.” Imagine a situation, where the colour would be related to the variable “class” of a car, that can take 5 values. What could we say more than to state the fact that the two are related? After all, in that case you end up with a contingency table of <span class="math inline">\(3\times 5\)</span>, and it might not be possible to say how specifically one variable changes with the change of another one. Still, Cramer’s V at least provides some information about the relation of two categorical variables.</p>
</div>
<div id="ordinal-scale-1" class="section level3" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Ordinal scale</h3>
<p>As discussed in Section <a href="scales.html#scales">1.2</a>, ordinal scale has more flexibility than the nominal one - its values have natural ordering, which can be used, when we want to measure relations between several variables in ordinal scale. Yes, we can use Cramer’s V and <span class="math inline">\(\chi^2\)</span> test, but this way we would not be using all advantages of the scale. So, what can we use in this case? There are three popular measures of association for variables in ordinal scale:</p>
<ol style="list-style-type: decimal">
<li>Goodman-Kruskal’s <span class="math inline">\(\gamma\)</span>,</li>
<li>Yule’s Q,</li>
<li>Kendall’s <span class="math inline">\(\tau\)</span>.</li>
</ol>
<p>Given that the ordinal scale does not have distances, the only thing we can do is to compare values of variables between different observations and say, whether one is greater than, less than or equal to another. What can be done with two variables in ordinal scale is the comparison of the values of those variables for a couple respondents. Based on that the pairs of the observations can be called:</p>
<ol style="list-style-type: decimal">
<li><strong>Concordant</strong> if both <span class="math inline">\(x_1 &lt; x_2\)</span> and <span class="math inline">\(y_1 &lt; y_2\)</span> or <span class="math inline">\(x_1 &gt; x_2\)</span> and <span class="math inline">\(y_1 &gt; y_2\)</span> - implying that there is an agreement in order between the two variables (e.g. with a switch from a younger age group to the older one, the size of the T-shirt will switch from S to M);</li>
<li><strong>Discordant</strong> if for <span class="math inline">\(x_1 &lt; x_2\)</span> and <span class="math inline">\(y_1 &gt; y_2\)</span> or for <span class="math inline">\(x_1 &gt; x_2\)</span> and <span class="math inline">\(y_1 &lt; y_2\)</span> - implying that there is a disagreement in the order of the two variables (e.g. with a switch from a younger age group to the older one, the satisfaction from drinking Coca-Cola will switch to the lower level);</li>
<li><strong>Ties</strong> if both <span class="math inline">\(x_1 = x_2\)</span> and <span class="math inline">\(y_1 = y_2\)</span>;</li>
<li>Neither otherwise (e.g. when <span class="math inline">\(x_1 = x_2\)</span> and <span class="math inline">\(y_1 &lt; y_2\)</span>).</li>
</ol>
<p>All the measures of association for the variables in ordinal scale rely on the number of concordant, discordant variables and number of ties. All of these measures lie in the region of [-1, 1].</p>
<p><strong>Goodman-Kruskal’s</strong> <span class="math inline">\(\gamma\)</span> is calculated using the following formula:
<span class="math display" id="eq:measuresAssociationGoodman">\[\begin{equation}
    \gamma = \frac{n_c - n_d}{n_c + n_d},
    \tag{2.10}
\end{equation}\]</span>
where <span class="math inline">\(n_c\)</span> is the number of concordant pairs, <span class="math inline">\(n_d\)</span> is the number of discordant pairs. This is a very simple measure of association, but it only works with scales of the same size (e.g. 5 options in one variable and 5 options in the other one) and ignores the ties.</p>
<p>In order to demonstrate this measure in action, we will create two artificial variables in ordinal scale:</p>
<ol style="list-style-type: decimal">
<li>Age of a person: young, adult and elderly;</li>
<li>Size of t-shirt they wear: S, M or L.</li>
</ol>
<p>Here how we can do that in R:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="correlations.html#cb60-1" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%*%</span> <span class="fu">rmultinom</span>(<span class="fu">nrow</span>(mtcars), <span class="dv">1</span>,</span>
<span id="cb60-2"><a href="correlations.html#cb60-2" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>))</span>
<span id="cb60-3"><a href="correlations.html#cb60-3" aria-hidden="true" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">factor</span>(age, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb60-4"><a href="correlations.html#cb60-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;young&quot;</span>,<span class="st">&quot;adult&quot;</span>,<span class="st">&quot;elderly&quot;</span>))</span>
<span id="cb60-5"><a href="correlations.html#cb60-5" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%*%</span> <span class="fu">rmultinom</span>(<span class="fu">nrow</span>(mtcars), <span class="dv">1</span>,</span>
<span id="cb60-6"><a href="correlations.html#cb60-6" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>))</span>
<span id="cb60-7"><a href="correlations.html#cb60-7" aria-hidden="true" tabindex="-1"></a>size <span class="ot">&lt;-</span> <span class="fu">factor</span>(size, <span class="at">levels=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>),</span>
<span id="cb60-8"><a href="correlations.html#cb60-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;S&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;L&quot;</span>))</span></code></pre></div>
<p>And here is how the relation between these two artificial variables looks:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="correlations.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tableplot</span>(age,size,<span class="at">xlab=</span><span class="st">&quot;Age&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;T-shirt size&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:tableplotAgeSize"></span>
<img src="adam_files/figure-html/tableplotAgeSize-1.png" alt="Heat map for age of a respondent and the size of their t-shirt." width="672" />
<p class="caption">
Figure 2.28: Heat map for age of a respondent and the size of their t-shirt.
</p>
</div>
<p>The graphical analysis based on Figure <a href="correlations.html#fig:tableplotAgeSize">2.28</a> does not provide a clear information about the relation between the two variables. But this is where the Goodman-Kruskal’s <span class="math inline">\(\gamma\)</span> becomes useful. We will use <code>GoodmanKruskalGamma()</code> function from <code>DescTools</code> package for R for this:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="correlations.html#cb62-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">GoodmanKruskalGamma</span>(age,size,<span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##       gamma      lwr.ci      upr.ci 
## -0.03846154 -0.51302449  0.43610141</code></pre>
<p>This function returns three values: the <span class="math inline">\(\gamma\)</span>, which is close to zero in our case, implying that there is no relation between the variables, lower and upper bounds of the 95% <a href="confidenceIntervals.html#confidenceIntervals">confidence interval</a>. Note that the interval shows us how big the uncertainty about the parameter is: the true value in the population can be anywhere between -0.51 and 0.44. But based on all these values we can conclude that we do not see any relation between the variables in our sample.</p>
<p>The next measure is called <strong>Yule’s Q</strong> and is considered as a special case of Goodman-Kruskal’s <span class="math inline">\(\gamma\)</span> for the variables that only have 2 options. It is calculated based on the resulting contingency <span class="math inline">\(2\times 2\)</span> table and has some similarities with the contingency coefficient <span class="math inline">\(\phi\)</span>:
<span class="math display" id="eq:measuresAssociationYule">\[\begin{equation}
    \mathrm{Q} = \frac{n_{1,1} n_{2,2} - n_{1,2} n_{2,1}}{n_{1,1} n_{2,2} + n_{1,2} n_{2,1}} .
    \tag{2.11}
\end{equation}\]</span>
The main difference from the contingency coefficient is that it assumes that the data has ordering, it implicitly relies on the number of concordant (on the diagonal) and discordant (on the off diagonal) pairs. In our case we could calculate it if we had two simplified variables based on age and size (in real life we would need to recode them to “young,” “older” and “S,” “Bigger than S” respectively):</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="correlations.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(age,size)[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>##        size
## age     S M
##   young 2 4
##   adult 2 2</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="correlations.html#cb66-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span><span class="sc">*</span><span class="dv">2-4</span><span class="sc">*</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">2</span><span class="sc">+</span><span class="dv">4</span><span class="sc">*</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] -0.3333333</code></pre>
<p>In our toy example, the measure shows that there is a weak negative relation between the trimmed age and size variables. We do not make any conclusions based on this, because this is not meaningful and is shown here just for purposes of demonstration.</p>
<p>Finally, there is <strong>Kendall’s</strong> <span class="math inline">\(\tau\)</span>. In fact, there are three different coefficients, which have the same name, so in the literature they are known as <span class="math inline">\(\tau_a\)</span>, <span class="math inline">\(\tau_b\)</span> and <span class="math inline">\(\tau_c\)</span>.</p>
<p><span class="math inline">\(\tau_a\)</span> coefficient is calculated using the formula:
<span class="math display" id="eq:measuresAssociationKendallTaua">\[\begin{equation}
    \tau_a = \frac{n_c - n_d}{\frac{T (T-1)}{2}},
    \tag{2.12}
\end{equation}\]</span>
where <span class="math inline">\(T\)</span> is the number of observations, and thus in the denominator, we have the number of all the pairs in the data. In theory this coefficient should lie between -1 and 1, but it does not solve the problem with ties, so typically it will not reach the boundary values and will say that the relation is weaker than it really is. Similar to Goodman-Kruskal’s <span class="math inline">\(\gamma\)</span>, it can only be applied to the variables that have the same number of levels (same sizes of scales). In order to resolve some of these issues, <span class="math inline">\(\tau_b\)</span> was developed:
<span class="math display" id="eq:measuresAssociationKendallTaub">\[\begin{equation}
    \tau_b = \frac{n_c - n_d}{\sqrt{\left(\frac{T (T-1)}{2} - n_x\right)\left(\frac{T (T-1)}{2} - n_y\right)}},
    \tag{2.13}
\end{equation}\]</span>
where <span class="math inline">\(n_x\)</span> and <span class="math inline">\(n_y\)</span> are the number of ties calculated for both variables. This coefficient resolves the problem with ties and can now reach the boundary values in practice. However, this coefficient does not resolve the issue with different scale sizes. And in order to address this problem, we have <span class="math inline">\(\tau_c\)</span> (<strong>Stuart-Kendall’s</strong> <span class="math inline">\(\tau_c\)</span>):
<span class="math display" id="eq:measuresAssociationKendallTaub">\[\begin{equation}
    \tau_c = \frac{n_c - n_d}{\frac{n^2}{2}\frac{\min(r, c)-1}{\min(r, c)}},
    \tag{2.13}
\end{equation}\]</span>
where <span class="math inline">\(r\)</span> is the number of rows and <span class="math inline">\(c\)</span> is the number of columns. This coefficient works for variables with different lengths of scales (e.g. age with 5 options and t-shirt size with 7 options). But now we are back to the problem with the ties…</p>
<p>In R, the <code>cor()</code> function implements Kendall’s <span class="math inline">\(\tau_a\)</span> and <span class="math inline">\(\tau_b\)</span> (the function will select automatically based on the presence of ties). There are also functions <code>KendallTauA()</code>, <code>KendallTauB()</code> and <code>StuartTauC()</code> in <code>DescTools</code> package that implement the three respective measures of association. The main limitation of <code>cor()</code> function is that it only works with numerical variables, so we would need to transform variables before applying the function. The functions from <code>DescTools</code> package, on the other hand, work with factors. Here are the values of the three coefficients for our case:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="correlations.html#cb68-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">KendallTauA</span>(age,size,<span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##       tau_a      lwr.ci      upr.ci 
## -0.01612903 -0.15347726  0.12121920</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="correlations.html#cb70-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">KendallTauB</span>(age,size,<span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##       tau_b      lwr.ci      upr.ci 
## -0.02469136 -0.32938991  0.28000720</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="correlations.html#cb72-1" aria-hidden="true" tabindex="-1"></a>DescTools<span class="sc">::</span><span class="fu">StuartTauC</span>(age,size,<span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##       tauc     lwr.ci     upr.ci 
## -0.0234375 -0.3126014  0.2657264</code></pre>
<p>Given that both variables have the same scale sizes, we should use either <span class="math inline">\(\tau_a\)</span> or <span class="math inline">\(\tau_b\)</span> for the analysis. However, we do not know if there are any ties in the data, so the safer option would be to use <span class="math inline">\(\tau_b\)</span> coefficient. The value of the coefficient and its confidence interval tell us that there is no obvious association between the two variables in our sample. This is expected, because the two variables were generated independently of each other.</p>
</div>
<div id="correlationCoefficient" class="section level3" number="2.6.3">
<h3><span class="header-section-number">2.6.3</span> Numerical scale</h3>
<p>Finally we come to the discussion of relations between variables measured in numerical scales. The most famous measure in this category is the <strong>Pearson’s correlation coefficient</strong>, which population value is:
<span class="math display" id="eq:measuresAssociationPearsonPopulation">\[\begin{equation}
    \rho_{x,y} = \frac{\sigma_{x,y}}{\sigma_x \sigma_y},
    \tag{2.14}
\end{equation}\]</span>
where <span class="math inline">\(\sigma_{x,y}\)</span> is the covariance between variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, while <span class="math inline">\(\sigma_x\)</span> and <span class="math inline">\(\sigma_y\)</span> are standard deviations of these variables. Typically, we do not know the population values, so this coefficient can be estimated in sample via:
<span class="math display" id="eq:measuresAssociationPearson">\[\begin{equation}
    r_{x,y} = \frac{\mathrm{cov}(x,y)}{\sqrt{V(x)V(y)}},
    \tag{2.15}
\end{equation}\]</span>
where all the values from <a href="correlations.html#eq:measuresAssociationPearsonPopulation">(2.14)</a> are substituted by their in-sample estimates. This coefficient measures the <strong>strength of linear relation</strong> between variables and lies between -1 and 1, where the boundary values correspond to perfect linear relation and 0 implies that there is no <strong>linear</strong> relation between the variables. In some textbooks the authors claim that this coefficient relies on Normal distribution of variables, but nothing in the formula assumes that. It was originally derived based on the simple linear regression (see Section <a href="simpleLinearRegression.html#simpleLinearRegression">3.1</a>) and its rough idea is to get information about the angle of the straight line drawn on the scatterplot. It might be easier to explain this on an example:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="correlations.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mtcarsData<span class="sc">$</span>disp,mtcarsData<span class="sc">$</span>mpg,</span>
<span id="cb74-2"><a href="correlations.html#cb74-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Displacement&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Mileage&quot;</span>)</span>
<span id="cb74-3"><a href="correlations.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(mpg<span class="sc">~</span>disp,mtcarsData),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:mtcarsScatterPlotDispMPG"></span>
<img src="adam_files/figure-html/mtcarsScatterPlotDispMPG-1.png" alt="Scatterplot for dispalcement vs mileage variables in mtcars dataset" width="672" />
<p class="caption">
Figure 2.29: Scatterplot for dispalcement vs mileage variables in mtcars dataset
</p>
</div>
<p>Figure <a href="correlations.html#fig:mtcarsScatterPlotDispMPG">2.29</a> shows the scatterplot between the two variables and also has the straight line, going through the cloud of points. The closer the points are to the line, the stronger the linear relation between the two variables is. The line corresponds to the formula <span class="math inline">\(\hat{y}=a_0+a_1 x\)</span>, where <span class="math inline">\(x\)</span> is the displacement and <span class="math inline">\(\hat{y}\)</span> is the line value for the Mileage. The same relation can be presented if we swap the axes and draw the line <span class="math inline">\(\hat{x}=b_0+b_1 y\)</span>:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="correlations.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mtcarsData<span class="sc">$</span>mpg,mtcarsData<span class="sc">$</span>disp,</span>
<span id="cb75-2"><a href="correlations.html#cb75-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Displacement&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Mileage&quot;</span>)</span>
<span id="cb75-3"><a href="correlations.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(disp<span class="sc">~</span>mpg,mtcarsData),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:mtcarsScatterPlotMPGDisp"></span>
<img src="adam_files/figure-html/mtcarsScatterPlotMPGDisp-1.png" alt="Scatterplot for mileage vs dispalcement" width="672" />
<p class="caption">
Figure 2.30: Scatterplot for mileage vs dispalcement
</p>
</div>
<p>The slopes for the two lines will in general differ, and will only coincide if the two variables have functional relations (all the point lie on the line). Based on this property, the correlation coefficient was originally constructed, as a geometric mean of the two parameters of slopes: <span class="math inline">\(r_{x,y}=\sqrt{a_1 b_1}\)</span>. We will come back to this specific formula later in Section <a href="simpleLinearRegression.html#simpleLinearRegression">3.1</a>. But this idea provides an explanation why the correlation coefficient measures the strength of linear relation. For the two variables of interest it will be:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="correlations.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(mtcarsData<span class="sc">$</span>mpg,mtcarsData<span class="sc">$</span>disp)</span></code></pre></div>
<pre><code>## [1] -0.8475514</code></pre>
<p>Which shows strong negative linear relation between the displacement and mileage. This makes sense, because in general the cars with bigger engines will have bigger consumption and thus will make less miles per gallon of fuel. The more detailed information about the correlation is provided by the <code>cor.test()</code> function:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="correlations.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(mtcarsData<span class="sc">$</span>mpg,mtcarsData<span class="sc">$</span>disp)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  mtcarsData$mpg and mtcarsData$disp
## t = -8.7472, df = 30, p-value = 9.38e-10
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.9233594 -0.7081376
## sample estimates:
##        cor 
## -0.8475514</code></pre>
<p>In addition to the value, we now have results of the hypothesis testing (where null hypothesis is <span class="math inline">\(\rho_{x,y}=0\)</span>) and the confidence interval for the parameter. Given that the value of the parameter is close to its bound, we could conclude that the linear relation between the two variables is strong and statistically significant on 1% level.</p>
<p>Note that the value of correlation coefficient only depends on the distance of points from the straight line, it does not depend on the slope (excluding case, when slope is equal to zero and thus the coefficient is equal to zero as well). So the following two cases will have exactly the same correlation coefficients:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="correlations.html#cb80-1" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb80-2"><a href="correlations.html#cb80-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb80-3"><a href="correlations.html#cb80-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="dv">10</span><span class="fl">+0.5</span><span class="sc">*</span>x<span class="fl">+0.5</span><span class="sc">*</span>error</span>
<span id="cb80-4"><a href="correlations.html#cb80-4" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="dv">2</span><span class="fl">+1.5</span><span class="sc">*</span>x<span class="fl">+1.5</span><span class="sc">*</span>error</span>
<span id="cb80-5"><a href="correlations.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce the plots</span></span>
<span id="cb80-6"><a href="correlations.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb80-7"><a href="correlations.html#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y1,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">200</span>))</span>
<span id="cb80-8"><a href="correlations.html#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y1<span class="sc">~</span>x),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb80-9"><a href="correlations.html#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">30</span>,<span class="dv">150</span>,<span class="fu">paste0</span>(<span class="st">&quot;r=&quot;</span>,<span class="fu">round</span>(<span class="fu">cor</span>(x,y1),<span class="dv">5</span>)))</span>
<span id="cb80-10"><a href="correlations.html#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y2,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">200</span>))</span>
<span id="cb80-11"><a href="correlations.html#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(y2<span class="sc">~</span>x),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb80-12"><a href="correlations.html#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">30</span>,<span class="dv">150</span>,<span class="fu">paste0</span>(<span class="st">&quot;r=&quot;</span>,<span class="fu">round</span>(<span class="fu">cor</span>(x,y2),<span class="dv">5</span>)))</span></code></pre></div>
<div class="figure"><span id="fig:correlationsScatterplotExample"></span>
<img src="adam_files/figure-html/correlationsScatterplotExample-1.png" alt="Example of relations with exactly the same correlations, but different slopes." width="672" />
<p class="caption">
Figure 2.31: Example of relations with exactly the same correlations, but different slopes.
</p>
</div>
<p>There are other examples of cases, when correlation coefficient would be misleading or not provide the necessary information. One of the canonical examples is the Anscombe’s quartet <span class="citation">(<a href="#ref-WikipediaAnscombeQuartet" role="doc-biblioref">Wikipedia, 2021a</a>)</span>, which shows very different types of relations, for which the Pearson’s correlation coefficient would be exactly the same. An important lesson from this is to always do graphical analysis (see Section <a href="dataAnalysis.html#dataAnalysisGraphical">2.1.2</a>) of your data, when possible - this way misleading situations can be avoided.</p>
<p>Coming back to the scatterplot in Figure <a href="correlations.html#fig:mtcarsScatterPlotDispMPG">2.29</a>, it demonstrates some non-linearity in the relation between the two variables. So, it would make sense to have a different measure that could take it into account. This is where <strong>Spearman’s correlation coefficient</strong> becomes useful. It is calculated using exactly the same formula <a href="correlations.html#eq:measuresAssociationPearson">(2.15)</a>, but applied to the data in ranks. By using ranks, we loose information about the natural zero and distances between values of the variable, but at the same time we linearise possible non-linear relations. So, Spearman’s coefficient shows the strength of monotonic relation between the two variables:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="correlations.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(mtcarsData<span class="sc">$</span>mpg,mtcarsData<span class="sc">$</span>disp,</span>
<span id="cb81-2"><a href="correlations.html#cb81-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in cor.test.default(mtcarsData$mpg, mtcarsData$disp, method =
## &quot;spearman&quot;): Cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  mtcarsData$mpg and mtcarsData$disp
## S = 10415, p-value = 6.37e-13
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.9088824</code></pre>
<p>We can notice that the value of the Spearman’s coefficient in our case is higher than the value of the Pearson’s correlation, which implies that there is indeed non-linear relation between variables. The two variables have a strong monotonic relation, which makes sense for the reasons discussed earlier. The non-linearity makes sense as well because the car with super powerful engines would still be able to do several miles on a gallon of fuel, no matter what. The relation will never be zero or even negative.</p>
<p>Note that while Spearman’s correlation will tell you something about monotonic relations, it will fail to capture all other non-linear relations between variables. For example, in the following case the true relation is trigonometric:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="correlations.html#cb84-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb84-2"><a href="correlations.html#cb84-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sin</span>(x)</span>
<span id="cb84-3"><a href="correlations.html#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="adam_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>But neither Pearson’s nor Spearman’s coefficients will be able to capture it:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="correlations.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x,y)</span></code></pre></div>
<pre><code>## [1] -0.04806497</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="correlations.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x,y,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## [1] -0.04649265</code></pre>
<p>In order to correctly diagnose such non-linear relation, either one or both variables need to be transformed to linearise the relation. In our case this implies measuring the relation between <span class="math inline">\(y\)</span> and <span class="math inline">\(\sin(x)\)</span> instead of <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="correlations.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="fu">sin</span>(x),y)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
</div>
<div id="correlationsMixed" class="section level3" number="2.6.4">
<h3><span class="header-section-number">2.6.4</span> Mixed scales</h3>
<p>Finally, when we have two variables measured in different scales, the general recommendation is to use the measure of association for the lower scale. For example, if we have the nominal variable colour and the ordinal variable size (both related to T-shirts people prefer), we should use Cramer’s V in order to measure the relation between them:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="correlations.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cramer</span>(colour,size)</span></code></pre></div>
<pre><code>## Cramer&#39;s V: 0.2991
## Chi^2 statistics = 5.7241, df: 4, p-value: 0.2207</code></pre>
<p>Similarly, if we have a numerical and ordinal variables, we should use one of the measures for ordinal scales.</p>
<p>However, in some cases we might be able to use a different measure of association. One of those is called multiple correlation coefficient and can be calculated for variables in numerical vs categorical scales. This coefficient can be calculated using different principles, the simplest of which is constructing a regression model (discussed later in Section <a href="linearRegression.html#linearRegression">3.2</a>) of numerical variable from the dummy variables (see Section <a href="dummyVariables.html#dummyVariables">3.4</a>) created from the categorical one and then extracting the square root of coefficient of determination (discussed in Section <a href="linearRegression.html#linearRegressionQualityOfFit">3.2.2</a>). The resulting coefficient lies between 0 and 1, where 1 implies perfect linear relation between the two variables and 0 implies no linear relation between them. <code>mcor()</code> function from <code>greybox</code> implements this:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="correlations.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcor</span>(mtcars<span class="sc">$</span>am, mtcars<span class="sc">$</span>mpg)</span></code></pre></div>
<pre><code>## Multiple correlations value: 0.5998
## F-statistics = 16.8603, df: 1, df resid: 30, p-value: 3e-04</code></pre>
<p>Based on the value above, we can conclude that the type of transmission has a linear relation with the mileage. This aligns with what we have already discovered earlier, in preliminary analysis section (Section <a href="dataAnalysis.html#dataAnalysisGraphical">2.1.2</a>) in Figure <a href="dataAnalysis.html#fig:vioAMMPG">2.14</a>.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-WikipediaAnscombeQuartet" class="csl-entry">
• Wikipedia, 2021a. <span class="nocase">Anscombe’s quartet</span>. <a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet">https://en.wikipedia.org/wiki/Anscombe%27s_quartet</a> (version: 2021-06-23)
</div>
</div>

            </section>

          </div>
        </div>
      </div>
<a href="hypothesisTesting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="distributions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/config-i1/adam/tree/master/Chapters//02-statistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["adam.pdf", "adam.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
