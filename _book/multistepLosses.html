<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11.3 Multistep losses | Forecasting and Analytics with ADAM</title>
  <meta name="description" content="This textbook explains how to do time series analysis and forecasting using Augmented Dynamic Adaptive Model, implemented in smooth package for R." />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="11.3 Multistep losses | Forecasting and Analytics with ADAM" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This textbook explains how to do time series analysis and forecasting using Augmented Dynamic Adaptive Model, implemented in smooth package for R." />
  <meta name="github-repo" content="config-i1/adam" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11.3 Multistep losses | Forecasting and Analytics with ADAM" />
  
  <meta name="twitter:description" content="This textbook explains how to do time series analysis and forecasting using Augmented Dynamic Adaptive Model, implemented in smooth package for R." />
  

<meta name="author" content="Ivan Svetunkov" />


<meta name="date" content="2021-07-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="non-mle-based-loss-functions.html"/>
<link rel="next" href="ADAMInitialisation.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script async defer src="https://hypothes.is/embed.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-XH37Z8VYP8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XH37Z8VYP8');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Forecasting and Analytics with ADAM</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i>License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="forecastingPlanningAnalytics.html"><a href="forecastingPlanningAnalytics.html"><i class="fa fa-check"></i><b>1.1</b> Forecasting, planning and analytics</a></li>
<li class="chapter" data-level="1.2" data-path="forecasting-principles.html"><a href="forecasting-principles.html"><i class="fa fa-check"></i><b>1.2</b> Forecasting principles</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="forecastsEvaluation.html"><a href="forecastsEvaluation.html"><i class="fa fa-check"></i><b>2</b> Forecasts evaluation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="errorMeasures.html"><a href="errorMeasures.html"><i class="fa fa-check"></i><b>2.1</b> Measuring accuracy of point forecasts</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="errorMeasures.html"><a href="errorMeasures.html#demonstration-in-r"><i class="fa fa-check"></i><b>2.1.1</b> Demonstration in R</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>2.2</b> Measuring uncertainty</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="uncertainty.html"><a href="uncertainty.html#example-in-r"><i class="fa fa-check"></i><b>2.2.1</b> Example in R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="errorMeasuresSelection.html"><a href="errorMeasuresSelection.html"><i class="fa fa-check"></i><b>2.3</b> How to choose appropriate error measure</a></li>
<li class="chapter" data-level="2.4" data-path="rollingOrigin.html"><a href="rollingOrigin.html"><i class="fa fa-check"></i><b>2.4</b> Rolling origin</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="rollingOrigin.html"><a href="rollingOrigin.html#principles-of-rolling-origin"><i class="fa fa-check"></i><b>2.4.1</b> Principles of Rolling origin</a></li>
<li class="chapter" data-level="2.4.2" data-path="rollingOrigin.html"><a href="rollingOrigin.html#rolling-origin-in-r"><i class="fa fa-check"></i><b>2.4.2</b> Rolling origin in R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="statisticalTests.html"><a href="statisticalTests.html"><i class="fa fa-check"></i><b>2.5</b> Statistical comparison of forecasts</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tsDecomposition.html"><a href="tsDecomposition.html"><i class="fa fa-check"></i><b>3</b> From time series components to ETS</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tsComponents.html"><a href="tsComponents.html"><i class="fa fa-check"></i><b>3.1</b> Time series components</a></li>
<li class="chapter" data-level="3.2" data-path="ClassicalDecomposition.html"><a href="ClassicalDecomposition.html"><i class="fa fa-check"></i><b>3.2</b> Classical Seasonal Decomposition</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ClassicalDecomposition.html"><a href="ClassicalDecomposition.html#how-to-do"><i class="fa fa-check"></i><b>3.2.1</b> How to do?</a></li>
<li class="chapter" data-level="3.2.2" data-path="ClassicalDecomposition.html"><a href="ClassicalDecomposition.html#a-couple-of-examples"><i class="fa fa-check"></i><b>3.2.2</b> A couple of examples</a></li>
<li class="chapter" data-level="3.2.3" data-path="ClassicalDecomposition.html"><a href="ClassicalDecomposition.html#other-techniques"><i class="fa fa-check"></i><b>3.2.3</b> Other techniques</a></li>
<li class="chapter" data-level="3.2.4" data-path="ClassicalDecomposition.html"><a href="ClassicalDecomposition.html#why-bother"><i class="fa fa-check"></i><b>3.2.4</b> “Why bother?”</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ETSTaxonomy.html"><a href="ETSTaxonomy.html"><i class="fa fa-check"></i><b>3.3</b> ETS taxonomy</a></li>
<li class="chapter" data-level="3.4" data-path="ETSTaxonomyMaths.html"><a href="ETSTaxonomyMaths.html"><i class="fa fa-check"></i><b>3.4</b> Mathematical models in the ETS taxonomy</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ETSConventional.html"><a href="ETSConventional.html"><i class="fa fa-check"></i><b>4</b> Conventional Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="4.1" data-path="SES.html"><a href="SES.html"><i class="fa fa-check"></i><b>4.1</b> Simple Exponential Smoothing</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="SES.html"><a href="SES.html#examples-of-application"><i class="fa fa-check"></i><b>4.1.1</b> Examples of application</a></li>
<li class="chapter" data-level="4.1.2" data-path="SES.html"><a href="SES.html#whyExponential"><i class="fa fa-check"></i><b>4.1.2</b> Why “exponential?”</a></li>
<li class="chapter" data-level="4.1.3" data-path="SES.html"><a href="SES.html#error-correction-form-of-ses"><i class="fa fa-check"></i><b>4.1.3</b> Error correction form of SES</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="SESandETS.html"><a href="SESandETS.html"><i class="fa fa-check"></i><b>4.2</b> SES and ETS</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="SESandETS.html"><a href="SESandETS.html#etsann"><i class="fa fa-check"></i><b>4.2.1</b> ETS(A,N,N)</a></li>
<li class="chapter" data-level="4.2.2" data-path="SESandETS.html"><a href="SESandETS.html#etsmnn"><i class="fa fa-check"></i><b>4.2.2</b> ETS(M,N,N)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ETSExamples.html"><a href="ETSExamples.html"><i class="fa fa-check"></i><b>4.3</b> Several examples of exponential smoothing methods and ETS</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ETSExamples.html"><a href="ETSExamples.html#ETSAAN"><i class="fa fa-check"></i><b>4.3.1</b> ETS(A,A,N)</a></li>
<li class="chapter" data-level="4.3.2" data-path="ETSExamples.html"><a href="ETSExamples.html#ETSAAdN"><i class="fa fa-check"></i><b>4.3.2</b> ETS(A,Ad,N)</a></li>
<li class="chapter" data-level="4.3.3" data-path="ETSExamples.html"><a href="ETSExamples.html#etsaam"><i class="fa fa-check"></i><b>4.3.3</b> ETS(A,A,M)</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ets-assumptions-estimation-and-selection.html"><a href="ets-assumptions-estimation-and-selection.html"><i class="fa fa-check"></i><b>4.4</b> ETS assumptions, estimation and selection</a></li>
<li class="chapter" data-level="4.5" data-path="state-space-form-of-ets.html"><a href="state-space-form-of-ets.html"><i class="fa fa-check"></i><b>4.5</b> State space form of ETS</a></li>
<li class="chapter" data-level="4.6" data-path="ETSParametersBounds.html"><a href="ETSParametersBounds.html"><i class="fa fa-check"></i><b>4.6</b> Parameters bounds</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ADAMETSIntroduction.html"><a href="ADAMETSIntroduction.html"><i class="fa fa-check"></i><b>5</b> Pure additive ADAM ETS</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ADAMETSPureAdditive.html"><a href="ADAMETSPureAdditive.html"><i class="fa fa-check"></i><b>5.1</b> Model formulation</a></li>
<li class="chapter" data-level="5.2" data-path="adamETSPureAdditiveRecursive.html"><a href="adamETSPureAdditiveRecursive.html"><i class="fa fa-check"></i><b>5.2</b> Recursive relation</a></li>
<li class="chapter" data-level="5.3" data-path="pureAdditiveExpectationAndVariance.html"><a href="pureAdditiveExpectationAndVariance.html"><i class="fa fa-check"></i><b>5.3</b> Conditional expectation and variance</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="pureAdditiveExpectationAndVariance.html"><a href="pureAdditiveExpectationAndVariance.html#example-with-etsann"><i class="fa fa-check"></i><b>5.3.1</b> Example with ETS(A,N,N)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="stabilityConditionAdditiveError.html"><a href="stabilityConditionAdditiveError.html"><i class="fa fa-check"></i><b>5.4</b> Stability and forecastability conditions</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="stabilityConditionAdditiveError.html"><a href="stabilityConditionAdditiveError.html#example-with-etsann-1"><i class="fa fa-check"></i><b>5.4.1</b> Example with ETS(A,N,N)</a></li>
<li class="chapter" data-level="5.4.2" data-path="stabilityConditionAdditiveError.html"><a href="stabilityConditionAdditiveError.html#comming-back-to-the-general-case"><i class="fa fa-check"></i><b>5.4.2</b> Comming back to the general case</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="ADAMETSAdditiveDistributions.html"><a href="ADAMETSAdditiveDistributions.html"><i class="fa fa-check"></i><b>5.5</b> Distributional assumptions in pure additive ETS</a></li>
<li class="chapter" data-level="5.6" data-path="ADAMETSPureAdditiveExamples.html"><a href="ADAMETSPureAdditiveExamples.html"><i class="fa fa-check"></i><b>5.6</b> Examples of application</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="ADAMETSPureAdditiveExamples.html"><a href="ADAMETSPureAdditiveExamples.html#non-seasonal-data"><i class="fa fa-check"></i><b>5.6.1</b> Non-seasonal data</a></li>
<li class="chapter" data-level="5.6.2" data-path="ADAMETSPureAdditiveExamples.html"><a href="ADAMETSPureAdditiveExamples.html#ADAMETSPureAdditiveExamplesETSAAA"><i class="fa fa-check"></i><b>5.6.2</b> Seasonal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ADAMETSPureMultiplicative.html"><a href="ADAMETSPureMultiplicative.html"><i class="fa fa-check"></i><b>6</b> Pure multiplicative ADAM ETS</a>
<ul>
<li class="chapter" data-level="6.1" data-path="adamETSPuremultiplicativeRecursive.html"><a href="adamETSPuremultiplicativeRecursive.html"><i class="fa fa-check"></i><b>6.1</b> Recursive relation</a></li>
<li class="chapter" data-level="6.2" data-path="pureMultiplicativeExpectationAndVariance.html"><a href="pureMultiplicativeExpectationAndVariance.html"><i class="fa fa-check"></i><b>6.2</b> The problem with moments in pure multiplicative ETS</a></li>
<li class="chapter" data-level="6.3" data-path="stabilityConditionMultiplicativeError.html"><a href="stabilityConditionMultiplicativeError.html"><i class="fa fa-check"></i><b>6.3</b> Smoothing parameters bounds</a></li>
<li class="chapter" data-level="6.4" data-path="ADAMETSMultiplicativeDistributions.html"><a href="ADAMETSMultiplicativeDistributions.html"><i class="fa fa-check"></i><b>6.4</b> Distributional assumptions in pure multiplicative ETS</a></li>
<li class="chapter" data-level="6.5" data-path="ADAMETSMultiplicativeExamples.html"><a href="ADAMETSMultiplicativeExamples.html"><i class="fa fa-check"></i><b>6.5</b> Examples of application</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="ADAMETSMultiplicativeExamples.html"><a href="ADAMETSMultiplicativeExamples.html#non-seasonal-data-1"><i class="fa fa-check"></i><b>6.5.1</b> Non-seasonal data</a></li>
<li class="chapter" data-level="6.5.2" data-path="ADAMETSMultiplicativeExamples.html"><a href="ADAMETSMultiplicativeExamples.html#seasonal-data"><i class="fa fa-check"></i><b>6.5.2</b> Seasonal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ADAMETSMixedModels.html"><a href="ADAMETSMixedModels.html"><i class="fa fa-check"></i><b>7</b> Further ADAM ETS topics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ADAMETSMixedModelsGroup3.html"><a href="ADAMETSMixedModelsGroup3.html"><i class="fa fa-check"></i><b>7.1</b> Mixed models with non-multiplicative trend</a></li>
<li class="chapter" data-level="7.2" data-path="ADAMETSMixedModelsGroup4.html"><a href="ADAMETSMixedModelsGroup4.html"><i class="fa fa-check"></i><b>7.2</b> Mixed models with multiplicative trend</a></li>
<li class="chapter" data-level="7.3" data-path="ADAMETSSeasonalNormalisation.html"><a href="ADAMETSSeasonalNormalisation.html"><i class="fa fa-check"></i><b>7.3</b> Normalisation of seasonal indices in ETS models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ARIMA.html"><a href="ARIMA.html"><i class="fa fa-check"></i><b>8</b> Conventional ARIMA</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html"><i class="fa fa-check"></i><b>8.1</b> Introduction to ARIMA</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#AR"><i class="fa fa-check"></i><b>8.1.1</b> AR(p)</a></li>
<li class="chapter" data-level="8.1.2" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#MA"><i class="fa fa-check"></i><b>8.1.2</b> MA(q)</a></li>
<li class="chapter" data-level="8.1.3" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#ARMA"><i class="fa fa-check"></i><b>8.1.3</b> ARMA(p,q)</a></li>
<li class="chapter" data-level="8.1.4" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#ARMAConstant"><i class="fa fa-check"></i><b>8.1.4</b> ARMA with constant</a></li>
<li class="chapter" data-level="8.1.5" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#Differences"><i class="fa fa-check"></i><b>8.1.5</b> I(d)</a></li>
<li class="chapter" data-level="8.1.6" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#arimapdq"><i class="fa fa-check"></i><b>8.1.6</b> ARIMA(p,d,q)</a></li>
<li class="chapter" data-level="8.1.7" data-path="ARIMAIntro.html"><a href="ARIMAIntro.html#ARIMABounds"><i class="fa fa-check"></i><b>8.1.7</b> Parameters bounds</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="seasonal-arima.html"><a href="seasonal-arima.html"><i class="fa fa-check"></i><b>8.2</b> Seasonal ARIMA</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="seasonal-arima.html"><a href="seasonal-arima.html#single-seasonal-arima"><i class="fa fa-check"></i><b>8.2.1</b> Single seasonal ARIMA</a></li>
<li class="chapter" data-level="8.2.2" data-path="seasonal-arima.html"><a href="seasonal-arima.html#sarima-with-constant"><i class="fa fa-check"></i><b>8.2.2</b> SARIMA with constant</a></li>
<li class="chapter" data-level="8.2.3" data-path="seasonal-arima.html"><a href="seasonal-arima.html#MSARIMA"><i class="fa fa-check"></i><b>8.2.3</b> Multiple seasonal ARIMA</a></li>
<li class="chapter" data-level="8.2.4" data-path="seasonal-arima.html"><a href="seasonal-arima.html#MSARIMABounds"><i class="fa fa-check"></i><b>8.2.4</b> Parameters bounds for MSARIMA</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="BJApproach.html"><a href="BJApproach.html"><i class="fa fa-check"></i><b>8.3</b> Box-Jenkins approach</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="BJApproach.html"><a href="BJApproach.html#identifying-stationarity"><i class="fa fa-check"></i><b>8.3.1</b> Identifying stationarity</a></li>
<li class="chapter" data-level="8.3.2" data-path="BJApproach.html"><a href="BJApproach.html#ACF"><i class="fa fa-check"></i><b>8.3.2</b> Autocorrelation function (ACF)</a></li>
<li class="chapter" data-level="8.3.3" data-path="BJApproach.html"><a href="BJApproach.html#PACF"><i class="fa fa-check"></i><b>8.3.3</b> Partial autocorrelation function (PACF)</a></li>
<li class="chapter" data-level="8.3.4" data-path="BJApproach.html"><a href="BJApproach.html#BJApproachSummary"><i class="fa fa-check"></i><b>8.3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html"><i class="fa fa-check"></i><b>8.4</b> ARIMA and ETS</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html#ARIMAETS011"><i class="fa fa-check"></i><b>8.4.1</b> ARIMA(0,1,1) and ETS(A,N,N)</a></li>
<li class="chapter" data-level="8.4.2" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html#ARIMAETS022"><i class="fa fa-check"></i><b>8.4.2</b> ARIMA(0,2,2) and ETS(A,A,N)</a></li>
<li class="chapter" data-level="8.4.3" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html#ARIMAETS112"><i class="fa fa-check"></i><b>8.4.3</b> ARIMA(1,1,2) and ETS(A,Ad,N)</a></li>
<li class="chapter" data-level="8.4.4" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html#arima-and-other-ets-models"><i class="fa fa-check"></i><b>8.4.4</b> ARIMA and other ETS models</a></li>
<li class="chapter" data-level="8.4.5" data-path="ARIMAandETS.html"><a href="ARIMAandETS.html#ets-arima"><i class="fa fa-check"></i><b>8.4.5</b> ETS + ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="ARIMAExampleInR.html"><a href="ARIMAExampleInR.html"><i class="fa fa-check"></i><b>8.5</b> Examples of application</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="ARIMAExampleInR.html"><a href="ARIMAExampleInR.html#non-seasonal-data-2"><i class="fa fa-check"></i><b>8.5.1</b> Non-seasonal data</a></li>
<li class="chapter" data-level="8.5.2" data-path="ARIMAExampleInR.html"><a href="ARIMAExampleInR.html#ARIMAExampleInRSeasonal"><i class="fa fa-check"></i><b>8.5.2</b> Seasonal data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ADAMARIMA.html"><a href="ADAMARIMA.html"><i class="fa fa-check"></i><b>9</b> ADAM ARIMA</a>
<ul>
<li class="chapter" data-level="9.1" data-path="StateSpaceARIMA.html"><a href="StateSpaceARIMA.html"><i class="fa fa-check"></i><b>9.1</b> State space ARIMA</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="StateSpaceARIMA.html"><a href="StateSpaceARIMA.html#StateSpaceARIMAAdditive"><i class="fa fa-check"></i><b>9.1.1</b> Additive ARIMA</a></li>
<li class="chapter" data-level="9.1.2" data-path="StateSpaceARIMA.html"><a href="StateSpaceARIMA.html#an-example"><i class="fa fa-check"></i><b>9.1.2</b> An example</a></li>
<li class="chapter" data-level="9.1.3" data-path="StateSpaceARIMA.html"><a href="StateSpaceARIMA.html#state-space-arima-with-constant"><i class="fa fa-check"></i><b>9.1.3</b> State space ARIMA with constant</a></li>
<li class="chapter" data-level="9.1.4" data-path="StateSpaceARIMA.html"><a href="StateSpaceARIMA.html#ADAMARIMAPureMultiplicative"><i class="fa fa-check"></i><b>9.1.4</b> Multiplicative ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ADAMARIMARecursive.html"><a href="ADAMARIMARecursive.html"><i class="fa fa-check"></i><b>9.2</b> Recursive relation</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ADAMARIMARecursive.html"><a href="ADAMARIMARecursive.html#moments-of-adam-arima"><i class="fa fa-check"></i><b>9.2.1</b> Moments of ADAM ARIMA</a></li>
<li class="chapter" data-level="9.2.2" data-path="ADAMARIMARecursive.html"><a href="ADAMARIMARecursive.html#parameters-bounds"><i class="fa fa-check"></i><b>9.2.2</b> Parameters bounds</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ADAMARIMADistributions.html"><a href="ADAMARIMADistributions.html"><i class="fa fa-check"></i><b>9.3</b> Distributional assumptions of ADAM ARIMA</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="ADAMARIMADistributions.html"><a href="ADAMARIMADistributions.html#conditional-distributions"><i class="fa fa-check"></i><b>9.3.1</b> Conditional distributions</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="ETSAndARIMA.html"><a href="ETSAndARIMA.html"><i class="fa fa-check"></i><b>9.4</b> ETS + ARIMA</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="ETSAndARIMA.html"><a href="ETSAndARIMA.html#pure-additive-models"><i class="fa fa-check"></i><b>9.4.1</b> Pure additive models</a></li>
<li class="chapter" data-level="9.4.2" data-path="ETSAndARIMA.html"><a href="ETSAndARIMA.html#pure-multiplicative-models"><i class="fa fa-check"></i><b>9.4.2</b> Pure multiplicative models</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="ADAMARIMAExamples.html"><a href="ADAMARIMAExamples.html"><i class="fa fa-check"></i><b>9.5</b> Examples of application</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ADAMX.html"><a href="ADAMX.html"><i class="fa fa-check"></i><b>10</b> Explanatory variables in ADAM</a>
<ul>
<li class="chapter" data-level="10.1" data-path="adamx-model-formulation.html"><a href="adamx-model-formulation.html"><i class="fa fa-check"></i><b>10.1</b> ADAMX: Model formulation</a></li>
<li class="chapter" data-level="10.2" data-path="ADAMXConventionalConditionalMoments.html"><a href="ADAMXConventionalConditionalMoments.html"><i class="fa fa-check"></i><b>10.2</b> Conditional expectation and variance of ADAMX</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="ADAMXConventionalConditionalMoments.html"><a href="ADAMXConventionalConditionalMoments.html#the-adamx-with-known-explanatory-variables"><i class="fa fa-check"></i><b>10.2.1</b> The ADAMX with known explanatory variables</a></li>
<li class="chapter" data-level="10.2.2" data-path="ADAMXConventionalConditionalMoments.html"><a href="ADAMXConventionalConditionalMoments.html#adamx-with-random-explanatory-variables"><i class="fa fa-check"></i><b>10.2.2</b> ADAMX with random explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="ADAMXDynamic.html"><a href="ADAMXDynamic.html"><i class="fa fa-check"></i><b>10.3</b> Dynamic X in ADAMX</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="ADAMXDynamic.html"><a href="ADAMXDynamic.html#conditional-moments-of-dynamic-adamx"><i class="fa fa-check"></i><b>10.3.1</b> Conditional moments of dynamic ADAMX</a></li>
<li class="chapter" data-level="10.3.2" data-path="ADAMXDynamic.html"><a href="ADAMXDynamic.html#known-explanatory-variables"><i class="fa fa-check"></i><b>10.3.2</b> Known explanatory variables</a></li>
<li class="chapter" data-level="10.3.3" data-path="ADAMXDynamic.html"><a href="ADAMXDynamic.html#random-explanatory-variables"><i class="fa fa-check"></i><b>10.3.3</b> Random explanatory variables</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="stability-and-forecastability-conditions-of-adamx.html"><a href="stability-and-forecastability-conditions-of-adamx.html"><i class="fa fa-check"></i><b>10.4</b> Stability and forecastability conditions of ADAMX</a></li>
<li class="chapter" data-level="10.5" data-path="ETSXDynamicCategories.html"><a href="ETSXDynamicCategories.html"><i class="fa fa-check"></i><b>10.5</b> Dealing with categorical variables in ADAMX</a></li>
<li class="chapter" data-level="10.6" data-path="ETSXRExample.html"><a href="ETSXRExample.html"><i class="fa fa-check"></i><b>10.6</b> Examples of application</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ADAMETSEstimation.html"><a href="ADAMETSEstimation.html"><i class="fa fa-check"></i><b>11</b> Estimation of ADAM models</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ADAMETSEstimationLikelihood.html"><a href="ADAMETSEstimationLikelihood.html"><i class="fa fa-check"></i><b>11.1</b> Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="ADAMETSEstimationLikelihood.html"><a href="ADAMETSEstimationLikelihood.html#an-example-in-r"><i class="fa fa-check"></i><b>11.1.1</b> An example in R</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html"><i class="fa fa-check"></i><b>11.2</b> Non MLE-based loss functions</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html#MSEandMAEEstimators"><i class="fa fa-check"></i><b>11.2.1</b> MSE and MAE</a></li>
<li class="chapter" data-level="11.2.2" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html#ham"><i class="fa fa-check"></i><b>11.2.2</b> HAM</a></li>
<li class="chapter" data-level="11.2.3" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html#lasso-and-ridge"><i class="fa fa-check"></i><b>11.2.3</b> LASSO and RIDGE</a></li>
<li class="chapter" data-level="11.2.4" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html#custom-losses"><i class="fa fa-check"></i><b>11.2.4</b> Custom losses</a></li>
<li class="chapter" data-level="11.2.5" data-path="non-mle-based-loss-functions.html"><a href="non-mle-based-loss-functions.html#examples-in-r"><i class="fa fa-check"></i><b>11.2.5</b> Examples in R</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="multistepLosses.html"><a href="multistepLosses.html"><i class="fa fa-check"></i><b>11.3</b> Multistep losses</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="multistepLosses.html"><a href="multistepLosses.html#mathrmmse_h---mse-for-h-steps-ahead"><i class="fa fa-check"></i><b>11.3.1</b> <span class="math inline">\(\mathrm{MSE}_h\)</span> - MSE for h steps ahead</a></li>
<li class="chapter" data-level="11.3.2" data-path="multistepLosses.html"><a href="multistepLosses.html#multistepLossesTMSE"><i class="fa fa-check"></i><b>11.3.2</b> TMSE - Trace MSE</a></li>
<li class="chapter" data-level="11.3.3" data-path="multistepLosses.html"><a href="multistepLosses.html#multistepLossesGTMSE"><i class="fa fa-check"></i><b>11.3.3</b> GTMSE - Geometric Trace MSE</a></li>
<li class="chapter" data-level="11.3.4" data-path="multistepLosses.html"><a href="multistepLosses.html#msce---mean-squared-cumulative-error"><i class="fa fa-check"></i><b>11.3.4</b> MSCE - Mean Squared Cumulative Error</a></li>
<li class="chapter" data-level="11.3.5" data-path="multistepLosses.html"><a href="multistepLosses.html#gpl---general-predictive-likelihood"><i class="fa fa-check"></i><b>11.3.5</b> GPL - General Predictive Likelihood</a></li>
<li class="chapter" data-level="11.3.6" data-path="multistepLosses.html"><a href="multistepLosses.html#other-multistep-estimators"><i class="fa fa-check"></i><b>11.3.6</b> Other multistep estimators</a></li>
<li class="chapter" data-level="11.3.7" data-path="multistepLosses.html"><a href="multistepLosses.html#an-example-in-r-1"><i class="fa fa-check"></i><b>11.3.7</b> An example in R</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html"><i class="fa fa-check"></i><b>11.4</b> Initialisation of ADAM</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html#ADAMInitialisationOptAndBack"><i class="fa fa-check"></i><b>11.4.1</b> Optimisation vs backcasting</a></li>
<li class="chapter" data-level="11.4.2" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html#pre-initialisation-of-adam-parameters"><i class="fa fa-check"></i><b>11.4.2</b> Pre-initialisation of ADAM parameters</a></li>
<li class="chapter" data-level="11.4.3" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html#pre-initialisation-of-adam-states-ets"><i class="fa fa-check"></i><b>11.4.3</b> Pre-initialisation of ADAM states, ETS</a></li>
<li class="chapter" data-level="11.4.4" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html#pre-initialisation-of-adam-states-arima"><i class="fa fa-check"></i><b>11.4.4</b> Pre-initialisation of ADAM states, ARIMA</a></li>
<li class="chapter" data-level="11.4.5" data-path="ADAMInitialisation.html"><a href="ADAMInitialisation.html#pre-initialisation-of-adam-states-regressors-and-constant"><i class="fa fa-check"></i><b>11.4.5</b> Pre-initialisation of ADAM states, Regressors and constant</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="multiple-frequencies-in-adam-ets.html"><a href="multiple-frequencies-in-adam-ets.html"><i class="fa fa-check"></i><b>12</b> Multiple frequencies in ADAM ETS</a>
<ul>
<li class="chapter" data-level="12.1" data-path="estimation-of-multiple-seasonal-model.html"><a href="estimation-of-multiple-seasonal-model.html"><i class="fa fa-check"></i><b>12.1</b> Estimation of multiple seasonal model</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="estimation-of-multiple-seasonal-model.html"><a href="estimation-of-multiple-seasonal-model.html#adam-ets-issues"><i class="fa fa-check"></i><b>12.1.1</b> ADAM ETS issues</a></li>
<li class="chapter" data-level="12.1.2" data-path="estimation-of-multiple-seasonal-model.html"><a href="estimation-of-multiple-seasonal-model.html#adam-arima-issues"><i class="fa fa-check"></i><b>12.1.2</b> ADAM ARIMA issues</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="ETSXMultipleSeasonality.html"><a href="ETSXMultipleSeasonality.html"><i class="fa fa-check"></i><b>12.2</b> Using explanatory variables for multiple seasonalities</a></li>
<li class="chapter" data-level="12.3" data-path="MultipleFrequenciesDSTandLeap.html"><a href="MultipleFrequenciesDSTandLeap.html"><i class="fa fa-check"></i><b>12.3</b> Dealing with daylight saving and leap years</a></li>
<li class="chapter" data-level="12.4" data-path="ADAMMultipleFrequenciesExamples.html"><a href="ADAMMultipleFrequenciesExamples.html"><i class="fa fa-check"></i><b>12.4</b> Examples of application</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="ADAMMultipleFrequenciesExamples.html"><a href="ADAMMultipleFrequenciesExamples.html#adam-ets"><i class="fa fa-check"></i><b>12.4.1</b> ADAM ETS</a></li>
<li class="chapter" data-level="12.4.2" data-path="ADAMMultipleFrequenciesExamples.html"><a href="ADAMMultipleFrequenciesExamples.html#adam-etsx"><i class="fa fa-check"></i><b>12.4.2</b> ADAM ETSX</a></li>
<li class="chapter" data-level="12.4.3" data-path="ADAMMultipleFrequenciesExamples.html"><a href="ADAMMultipleFrequenciesExamples.html#adam-arima"><i class="fa fa-check"></i><b>12.4.3</b> ADAM ARIMA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ADAMIntermittent.html"><a href="ADAMIntermittent.html"><i class="fa fa-check"></i><b>13</b> ADAM for Intermittent Demand</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html"><i class="fa fa-check"></i><b>13.1</b> Occurrence part of the model</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#fixed-probability-model-oets_f"><i class="fa fa-check"></i><b>13.1.1</b> Fixed probability model, oETS<span class="math inline">\(_F\)</span></a></li>
<li class="chapter" data-level="13.1.2" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#oETSO"><i class="fa fa-check"></i><b>13.1.2</b> Odds ratio model, oETS<span class="math inline">\(_O\)</span></a></li>
<li class="chapter" data-level="13.1.3" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#inverse-odds-ratio-model-oets_i"><i class="fa fa-check"></i><b>13.1.3</b> Inverse odds ratio model, oETS<span class="math inline">\(_I\)</span></a></li>
<li class="chapter" data-level="13.1.4" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#oETSG"><i class="fa fa-check"></i><b>13.1.4</b> General oETS model, oETS<span class="math inline">\(_G\)</span></a></li>
<li class="chapter" data-level="13.1.5" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#direct-probability-model-oets_d"><i class="fa fa-check"></i><b>13.1.5</b> Direct probability model, oETS<span class="math inline">\(_D\)</span></a></li>
<li class="chapter" data-level="13.1.6" data-path="ADAMOccurrence.html"><a href="ADAMOccurrence.html#oETSModelSelection"><i class="fa fa-check"></i><b>13.1.6</b> Model selection in oETS</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="ADAMDemandSizes.html"><a href="ADAMDemandSizes.html"><i class="fa fa-check"></i><b>13.2</b> Demand sizes part of the model</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ADAMDemandSizes.html"><a href="ADAMDemandSizes.html#additive-vs-multiplicative-ets-for-demand-sizes"><i class="fa fa-check"></i><b>13.2.1</b> Additive vs multiplicative ETS for demand sizes</a></li>
<li class="chapter" data-level="13.2.2" data-path="ADAMDemandSizes.html"><a href="ADAMDemandSizes.html#using-arima-for-demand-sizes"><i class="fa fa-check"></i><b>13.2.2</b> Using ARIMA for demand sizes</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ADAMIntermittentFull.html"><a href="ADAMIntermittentFull.html"><i class="fa fa-check"></i><b>13.3</b> The full ADAM model</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="ADAMIntermittentFull.html"><a href="ADAMIntermittentFull.html#iETSMLE"><i class="fa fa-check"></i><b>13.3.1</b> Maximum Likelihood Estimation</a></li>
<li class="chapter" data-level="13.3.2" data-path="ADAMIntermittentFull.html"><a href="ADAMIntermittentFull.html#conditional-expectation-and-variance"><i class="fa fa-check"></i><b>13.3.2</b> Conditional expectation and variance</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="examples-of-application-1.html"><a href="examples-of-application-1.html"><i class="fa fa-check"></i><b>13.4</b> Examples of application</a></li>
<li class="chapter" data-level="13.5" data-path="intermittent-demand-challenges.html"><a href="intermittent-demand-challenges.html"><i class="fa fa-check"></i><b>13.5</b> Intermittent demand challenges</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="diagnostics.html"><a href="diagnostics.html"><i class="fa fa-check"></i><b>14</b> Model diagnostics</a>
<ul>
<li class="chapter" data-level="14.1" data-path="diagnosticsOmitted.html"><a href="diagnosticsOmitted.html"><i class="fa fa-check"></i><b>14.1</b> Model specification: Omitted variables</a></li>
<li class="chapter" data-level="14.2" data-path="diagnosticsRedundant.html"><a href="diagnosticsRedundant.html"><i class="fa fa-check"></i><b>14.2</b> Model specification: Redundant variables</a></li>
<li class="chapter" data-level="14.3" data-path="diagnosticsTransformations.html"><a href="diagnosticsTransformations.html"><i class="fa fa-check"></i><b>14.3</b> Model specification: Transformations</a></li>
<li class="chapter" data-level="14.4" data-path="diagnosticsOutliers.html"><a href="diagnosticsOutliers.html"><i class="fa fa-check"></i><b>14.4</b> Model specification: Outliers</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="diagnosticsOutliers.html"><a href="diagnosticsOutliers.html#outliers-detection"><i class="fa fa-check"></i><b>14.4.1</b> Outliers detection</a></li>
<li class="chapter" data-level="14.4.2" data-path="diagnosticsOutliers.html"><a href="diagnosticsOutliers.html#dealing-with-outliers"><i class="fa fa-check"></i><b>14.4.2</b> Dealing with outliers</a></li>
<li class="chapter" data-level="14.4.3" data-path="diagnosticsOutliers.html"><a href="diagnosticsOutliers.html#an-automatic-mechanism"><i class="fa fa-check"></i><b>14.4.3</b> An automatic mechanism</a></li>
<li class="chapter" data-level="14.4.4" data-path="diagnosticsOutliers.html"><a href="diagnosticsOutliers.html#final-remarks"><i class="fa fa-check"></i><b>14.4.4</b> Final remarks</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="diagnosticsResidualsIIDAuto.html"><a href="diagnosticsResidualsIIDAuto.html"><i class="fa fa-check"></i><b>14.5</b> Residuals are i.i.d.: autocorrelation</a></li>
<li class="chapter" data-level="14.6" data-path="diagnosticsResidualsIIDHetero.html"><a href="diagnosticsResidualsIIDHetero.html"><i class="fa fa-check"></i><b>14.6</b> Residuals are i.i.d.: heteroscedasticity</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="diagnosticsResidualsIIDHetero.html"><a href="diagnosticsResidualsIIDHetero.html#detecting-heteroscedasticity"><i class="fa fa-check"></i><b>14.6.1</b> Detecting heteroscedasticity</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="diagnosticsResidualsIIDExpectation.html"><a href="diagnosticsResidualsIIDExpectation.html"><i class="fa fa-check"></i><b>14.7</b> Residuals are i.i.d.: zero expectation</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="diagnosticsResidualsIIDExpectation.html"><a href="diagnosticsResidualsIIDExpectation.html#diagnosticsResidualsIIDExpectationMultiple"><i class="fa fa-check"></i><b>14.7.1</b> Multistep forecast errors have zero mean</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="diagnosticsResidualsIIDDistribution.html"><a href="diagnosticsResidualsIIDDistribution.html"><i class="fa fa-check"></i><b>14.8</b> Residuals are i.i.d.: distributional assumptions</a></li>
<li class="chapter" data-level="14.9" data-path="diagnosticsMulticollinearity.html"><a href="diagnosticsMulticollinearity.html"><i class="fa fa-check"></i><b>14.9</b> Multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="ADAMSelection.html"><a href="ADAMSelection.html"><i class="fa fa-check"></i><b>15</b> Model selection and combinations in ADAM</a>
<ul>
<li class="chapter" data-level="15.1" data-path="ETSSelection.html"><a href="ETSSelection.html"><i class="fa fa-check"></i><b>15.1</b> ADAM ETS components selection</a></li>
<li class="chapter" data-level="15.2" data-path="ARIMASelection.html"><a href="ARIMASelection.html"><i class="fa fa-check"></i><b>15.2</b> ADAM ARIMA order selection</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="ARIMASelection.html"><a href="ARIMASelection.html#ets-arima-restrictions"><i class="fa fa-check"></i><b>15.2.1</b> ETS + ARIMA restrictions</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="ETSXSelection.html"><a href="ETSXSelection.html"><i class="fa fa-check"></i><b>15.3</b> Explanatory variables selection</a></li>
<li class="chapter" data-level="15.4" data-path="ADAMCombinations.html"><a href="ADAMCombinations.html"><i class="fa fa-check"></i><b>15.4</b> Forecasts combinations in ADAM</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ADAMUncertainty.html"><a href="ADAMUncertainty.html"><i class="fa fa-check"></i><b>16</b> Handling uncertainty in ADAM</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ADAMUncertaintyVCOV.html"><a href="ADAMUncertaintyVCOV.html"><i class="fa fa-check"></i><b>16.1</b> Covariance matrix of parameters</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="ADAMUncertaintyVCOV.html"><a href="ADAMUncertaintyVCOV.html#bootstrapped-covariance-matrix"><i class="fa fa-check"></i><b>16.1.1</b> Bootstrapped covariance matrix</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="confidence-intervals-for-parameters.html"><a href="confidence-intervals-for-parameters.html"><i class="fa fa-check"></i><b>16.2</b> Confidence intervals for parameters</a></li>
<li class="chapter" data-level="16.3" data-path="conditional-variance-with-uncertain-parameters.html"><a href="conditional-variance-with-uncertain-parameters.html"><i class="fa fa-check"></i><b>16.3</b> Conditional variance with uncertain parameters</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="conditional-variance-with-uncertain-parameters.html"><a href="conditional-variance-with-uncertain-parameters.html#estimated-initial-state"><i class="fa fa-check"></i><b>16.3.1</b> Estimated initial state</a></li>
<li class="chapter" data-level="16.3.2" data-path="conditional-variance-with-uncertain-parameters.html"><a href="conditional-variance-with-uncertain-parameters.html#estimated-parameters-of-adam-model"><i class="fa fa-check"></i><b>16.3.2</b> Estimated parameters of ADAM model</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="adamRefitted.html"><a href="adamRefitted.html"><i class="fa fa-check"></i><b>16.4</b> Multi-scenarios for ADAM states</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="ADAMForecasting.html"><a href="ADAMForecasting.html"><i class="fa fa-check"></i><b>17</b> Forecasting with ADAM</a>
<ul>
<li class="chapter" data-level="17.1" data-path="ADAMForecastingExpectation.html"><a href="ADAMForecastingExpectation.html"><i class="fa fa-check"></i><b>17.1</b> Producing conditional expectations</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="ADAMForecastingExpectation.html"><a href="ADAMForecastingExpectation.html#ADAMForecastingExpectationSimulations"><i class="fa fa-check"></i><b>17.1.1</b> Simulating demand trajectories</a></li>
<li class="chapter" data-level="17.1.2" data-path="ADAMForecastingExpectation.html"><a href="ADAMForecastingExpectation.html#demonstration-in-r-1"><i class="fa fa-check"></i><b>17.1.2</b> Demonstration in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting and Analytics with ADAM</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div class = rmdreview>
This book is in <b><a href="open.html#open">Open Review</a></b>. I want your feedback to make the book better for you and other readers. To add your annotation, <span style="background-color: #3297FD; color: white">select some text</span> and then click the <i class="h-icon-annotate"></i> on the pop-up menu. To see the annotations of others, click the button in the upper right hand corner of the page <i class="fa fa-arrow-circle-right  fa-rotate-315" aria-hidden="true"></i>
</div>
<div id="multistepLosses" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Multistep losses</h2>
<p>Another class of losses that can be used in the estimation of ADAM models is the multistep losses. The idea behind them is to produce the point forecast for <span class="math inline">\(h\)</span> steps ahead from each observation in sample and then calculate a measure based on that, which will be minimised by the optimiser in order to find the most suitable values of parameters. There is a lot of literature on this topic, <span class="citation"><a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">Svetunkov et al.</a> (<a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">2021</a>)</span> studied them in detail, showing that their usage implies shrinkage of smoothing parameters in case of ETS models. In this section we will discuss the most popular multistep losses, see what they imply and make a connection between these losses and predictive likelihoods from the ETS models.</p>
<div id="mathrmmse_h---mse-for-h-steps-ahead" class="section level3" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> <span class="math inline">\(\mathrm{MSE}_h\)</span> - MSE for h steps ahead</h3>
<p>One of the simplest estimators is the <span class="math inline">\(\mathrm{MSE}_h\)</span> - mean squared <span class="math inline">\(h\)</span>-steps ahead error:
<span class="math display" id="eq:hstepsMSE">\[\begin{equation}
    \mathrm{MSE}_h = \frac{1}{T-h} \sum_{t=1}^{T-h} e_{t+h|t}^2 ,
  \tag{11.8}
\end{equation}\]</span>
where <span class="math inline">\(e_{t+h|t} = y_{t+h} - \hat{\mu}_{t+h|t}\)</span> is the conditional <span class="math inline">\(h\)</span> steps ahead forecast error on the observation <span class="math inline">\(t+h\)</span> produced from the point at time <span class="math inline">\(t\)</span>. This estimator is sometimes used to fit a model several times, for each horizon from 1 to <span class="math inline">\(h\)</span> steps ahead, resulting in <span class="math inline">\(h\)</span> different values of parameters for each <span class="math inline">\(j=1, \ldots, h\)</span>. The estimation process in this case becomes at least <span class="math inline">\(h\)</span> times more complicated than estimating one model, but is reported to result in increased accuracy. <span class="citation"><a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">Svetunkov et al.</a> (<a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">2021</a>)</span> show that MSE<span class="math inline">\(_h\)</span> is proportional to the h steps ahead forecast error variance <span class="math inline">\(V(y_{t+h}|t)=\sigma^2_{h}\)</span>, which implies that the minimisation of <a href="multistepLosses.html#eq:hstepsMSE">(11.8)</a> leads to the minimisation of the variance and in turn to the minimisation of both one step ahead MSE and a combination of smoothing parameters of a model. This becomes more obvious in the case of <a href="ADAMETSPureAdditive.html#ADAMETSPureAdditive">pure additive ETS</a>, where the <a href="pureAdditiveExpectationAndVariance.html#pureAdditiveExpectationAndVariance">analytical formulae for variance</a> are available. The parameters are shrunk towards zero in case of ETS, making the model deterministic. The effect is neglected on large samples, when the ratio <span class="math inline">\(\frac{T-h}{T-1}\)</span> becomes close to one. In case of ARIMA, the shrinkage mechanism is similar, making models closer to the deterministic ones, but the direction of shrinkage is more complicating. The strength of shrinkage is proportional to the forecast horizon <span class="math inline">\(h\)</span> and is weakened with the increase of the sample size.</p>
<p><span class="citation"><a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">Svetunkov et al.</a> (<a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">2021</a>)</span> demonstrate that the minimum of MSE<span class="math inline">\(_h\)</span> corresponds to the maximum of the predictive likelihood based on the normal distribution, assuming that <span class="math inline">\(\epsilon_t \sim N(0,\sigma^2)\)</span>. The log-likelihood in this case is:
<span class="math display" id="eq:LikelihoodMSEh">\[\begin{equation}
    \ell_{\mathrm{MSE}_h}(\theta, {\sigma^2_h} | \mathbf{y}) = -\frac{T-h}{2} \left( \log(2 \pi) + \log \sigma^2_h \right) -\frac{1}{2} \sum_{t=1}^{T-h} \left( \frac{\eta_{t+h|}^2}{\sigma^2_h} \right) ,
  \tag{11.9}
\end{equation}\]</span>
where <span class="math inline">\(\eta_{t+h|} \sim N(0, \sigma_h^2)\)</span> is the h steps ahead forecast error, conditional on the information available at time <span class="math inline">\(t\)</span>, <span class="math inline">\(\theta\)</span> is the vector of all estimated parameters of the model and <span class="math inline">\(\mathbf{y}\)</span> is the vector of <span class="math inline">\(y_{t+h}\)</span> for all <span class="math inline">\(t=1,..,T-h\)</span>. The MLE of the scale parameter in <a href="multistepLosses.html#eq:LikelihoodMSEh">(11.9)</a> coincides with the MSE<span class="math inline">\(_h\)</span>:
<span class="math display" id="eq:hstepsSigma">\[\begin{equation}
    \hat{\sigma}_h = \frac{1}{T-h} \sum_{t=1}^{T-h} e_{t+h|t}^2 ,
  \tag{11.10}
\end{equation}\]</span>
where <span class="math inline">\(e_{t+h|t}\)</span> is the in sample estimate of the <span class="math inline">\(\eta_{t+h}\)</span>. The formula <a href="multistepLosses.html#eq:LikelihoodMSEh">(11.9)</a> can be used for the calculation of information criteria and in turn for the model selection in cases, when MSE<span class="math inline">\(_h\)</span> is used for the model estimation.</p>
<p><span class="citation"><a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">Svetunkov et al.</a> (<a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">2021</a>)</span> demonstrate that <a href="multistepLosses.html#eq:hstepsMSE">(11.8)</a> is <a href="#estimatesProperties">more efficient</a> than the conventional MSE<span class="math inline">\(_1\)</span> one, when the true smoothing parameters are close to zero and is less efficient otherwise. On smaller samples, MSE<span class="math inline">\(_h\)</span> produces biased estimates of parameters due to shrinkage. This can still be considered as advantage if you are interested in forecasting and do not want the smoothing parameters to vary a lot.</p>
</div>
<div id="multistepLossesTMSE" class="section level3" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> TMSE - Trace MSE</h3>
<p>An alternative to MSE<span class="math inline">\(_h\)</span> is to produce 1 to <span class="math inline">\(h\)</span> steps ahead forecasts and calculate the respective forecast errors. Then, based on that, we can calculate the overall measure, which we will call “Trace MSE”:
<span class="math display" id="eq:TMSE">\[\begin{equation}
    \mathrm{TMSE} = \sum_{j=1}^h \frac{1}{T-h} \sum_{t=1}^{T-h} e_{t+j|t}^2 .
  \tag{11.11}
\end{equation}\]</span>
The benefit of this estimator is in minimising the error for the whole 1 to <span class="math inline">\(h\)</span> steps ahead in one model - there is no need to construct <span class="math inline">\(h\)</span> models, minimising MSE<span class="math inline">\(_j\)</span>, <span class="math inline">\(j=1,...,h\)</span>. However, this comes with a cost: typically short term forecast errors have lower MSE than the longer term ones, so if we just sum their squares up, we are mixing different values, and the minimisation will be done mainly for the ones on the longer horizons.</p>
<p>TMSE does not have a related predictive likelihood, so it is difficult to study its properties, but the simulations show that it tends to produce less biased and more efficient estimates of parameters than MSE<span class="math inline">\(_h\)</span>. <span class="citation"><a href="#ref-Kourentzes2019" role="doc-biblioref">Kourentzes et al.</a> (<a href="#ref-Kourentzes2019" role="doc-biblioref">2019c</a>)</span> showed that TMSE performs well in comparison with the conventional MSE<span class="math inline">\(_1\)</span> and MSE<span class="math inline">\(_h\)</span> in terms of forecasting accuracy and does not take as much time as the estimation of <span class="math inline">\(h\)</span> models using MSE<span class="math inline">\(_h\)</span>.</p>
</div>
<div id="multistepLossesGTMSE" class="section level3" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> GTMSE - Geometric Trace MSE</h3>
<p>An estimator that addresses the issues of TMSE, is the GTMSE, which is derived from a so called General Predictive Likelihood <span class="citation">(GPL by <a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">Svetunkov et al., 2021</a>)</span>. The word “Geometric” sums up how the value is calculated:
<span class="math display" id="eq:GTMSE">\[\begin{equation}
    \mathrm{GTMSE} =  \sum_{j=1}^h \log \left(\frac{1}{T-h} \sum_{t=1}^{T-h} e_{t+j|t}^2 \right).
  \tag{11.12}
\end{equation}\]</span>
Logarithms in the formula <a href="multistepLosses.html#eq:GTMSE">(11.12)</a> bring the MSEs on different horizons to the same level, so that the both short term and long term errors are minimised with a similar power. As a result, the shrinkage effect in this estimator is milder than in MSE<span class="math inline">\(_h\)</span> and in TMSE and the estimates of parameters are less biased and more efficient on smaller samples. It still has the benefits of other multistep estimators, shrinking the parameters towards zero. Although it is possible to derive a predictive likelihood that would be maximised, when GTMSE is minimised, it relies on unrealistic assumptions of independence of multistep forecast errors (they are always correlated as long as smoothing parameters are not zero).</p>
</div>
<div id="msce---mean-squared-cumulative-error" class="section level3" number="11.3.4">
<h3><span class="header-section-number">11.3.4</span> MSCE - Mean Squared Cumulative Error</h3>
<p>This estimator alings the loss function with a specific inventory decision: ordering based on the lead time <span class="math inline">\(h\)</span>:
<span class="math display" id="eq:MSCE">\[\begin{equation}
    \mathrm{MSCE} = \frac{1}{T-h} \sum_{t=1}^{T-h} \left( \sum_{j=1}^h e_{t+j|t} \right)^2 .
  \tag{11.13}
\end{equation}\]</span>
<span class="citation"><a href="#ref-kourentzes2019unconstraining" role="doc-biblioref">Kourentzes et al.</a> (<a href="#ref-kourentzes2019unconstraining" role="doc-biblioref">2019b</a>)</span> demonstrated that it produces more accurate forecasts in cases of intermittent demand and leads to less revenue losses. <span class="citation"><a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">Svetunkov et al.</a> (<a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">2021</a>)</span> show that the shrinkage effect is much stronger in this estimator than in the other estimators discussed in this section. In addition, it is possible to derive a predictive log-likelihood related to this estimator:
<span class="math display" id="eq:LikelihoodMSCE">\[\begin{equation}
    \ell_{\mathrm{MSCE}}(\theta, {\varsigma^2_h} | \mathbf{z}) = -\frac{T-h}{2} \left( \log(2 \pi) + \log {\varsigma^2_h} \right) -\frac{1}{2} \sum_{t=1}^{T-h} \left( \frac{\left(\sum_{j=1}^h \eta_{t+j|t}\right)^2}{2 {\varsigma^2_h}} \right) ,
  \tag{11.14}
\end{equation}\]</span>
where <span class="math inline">\(\mathbf{z}\)</span> is the cumulative sum of actual values, the vector of <span class="math inline">\(z_t=\sum_{j=1}^h y_{t+j}\)</span> for all <span class="math inline">\(t=1, \ldots, T-h\)</span> and <span class="math inline">\({\varsigma^2_h}\)</span> is the variance of the cumulative error term, the MLE of which is equal to <a href="multistepLosses.html#eq:MSCE">(11.13)</a>. Having the likelihood <a href="multistepLosses.html#eq:LikelihoodMSCE">(11.14)</a> permits the model selection and combination using <a href="#modelSelection">information criteria</a> and also means that the parameters estimated using MSCE will be asymptotically consistent and efficient.</p>
</div>
<div id="gpl---general-predictive-likelihood" class="section level3" number="11.3.5">
<h3><span class="header-section-number">11.3.5</span> GPL - General Predictive Likelihood</h3>
<p>Finally, <span class="citation"><a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">Svetunkov et al.</a> (<a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">2021</a>)</span> studied the General Predictive Likelihood for normally distributed variable from <span class="citation"><a href="#ref-Clements1998" role="doc-biblioref">Clements and Hendry</a> (<a href="#ref-Clements1998" role="doc-biblioref">1998</a>)</span>, p.77, logarithm version of which can be written as:
<span class="math display" id="eq:logGPL">\[\begin{equation}
    \ell_{\mathrm{GPL}_h}(\theta, \mathbf{{\Sigma}} | \mathbf{Y}) = -\frac{T-h}{2} \left( h \log(2 \pi) + \log | \mathbf{{\Sigma}}| \right) -\frac{1}{2} \sum_{t=1}^T \left( \mathbf{E_t^\prime} \mathbf{{\Sigma}}^{-1} \mathbf{E_t} \right) ,
  \tag{11.15}
\end{equation}\]</span>
where <span class="math inline">\(\mathbf{{\Sigma}}\)</span> is the conditional covariance matrix for variable <span class="math inline">\(\mathbf{Y}_t\)</span>, <span class="math inline">\(\mathbf{Y}\)</span> is the matrix consisting of  for all <span class="math inline">\(t=1, \ldots, T-h\)</span> and <span class="math inline">\(\mathbf{E_t}^{\prime} = \begin{pmatrix} \eta_{t+1|t} &amp; \eta_{t+2|t} &amp; \ldots &amp; \eta_{t+h|t} \end{pmatrix}\)</span> is the vector of 1 to <span class="math inline">\(h\)</span> steps ahead forecast errors. <span class="citation"><a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">Svetunkov et al.</a> (<a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">2021</a>)</span> showed that the maximisation of the likelihood <a href="multistepLosses.html#eq:logGPL">(11.15)</a> is equivalent to minimising the generalised variance of the error term, <span class="math inline">\(|\mathbf{\hat{\Sigma}}|\)</span>, where:
<span class="math display" id="eq:Sigmaest">\[\begin{equation}
    \mathbf{\hat{\Sigma}} = \frac{1}{T-h} \sum_{t=1}^{T-h} \mathbf{E_t} \mathbf{E_t^\prime} =
    \begin{pmatrix}
        \hat{\sigma}_1^2 &amp; \hat{\sigma}_{1,2} &amp; \dots &amp; \hat{\sigma}_{1,h} \\
        \hat{\sigma}_{1,2} &amp; \hat{\sigma}_2^2 &amp; \dots &amp; \hat{\sigma}_{2,h} \\
        \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
        \hat{\sigma}_{1,h} &amp; \hat{\sigma}_{2,h} &amp; \dots &amp; \hat{\sigma}_h^2
    \end{pmatrix} ,
    \tag{11.16}
\end{equation}\]</span>
where <span class="math inline">\(\hat{\sigma}_{i,j}\)</span> is the covariance between <span class="math inline">\(i\)</span>-th and <span class="math inline">\(j\)</span>-th steps ahead forecast errors. <span class="citation"><a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">Svetunkov et al.</a> (<a href="#ref-Svetunkov2020Multistep" role="doc-biblioref">2021</a>)</span> show that this estimator encompassess all the other estimators discussed in this section: minimising MSE<span class="math inline">\(_h\)</span> is equivalent to minimising the <span class="math inline">\(\hat{\sigma}^2_{h}\)</span>; minimising TMSE is equivalent to minimising the trace of the matrix <span class="math inline">\(\mathbf{\hat{\Sigma}}\)</span>; minimising GTMSE is the same as minimising the determinant of <span class="math inline">\(\mathbf{\hat{\Sigma}}\)</span> but with the restriction that all off-diagonal elements are equal to zero; minimising MSCE produces the same results as minimising the sum of all elements in <span class="math inline">\(\mathbf{\hat{\Sigma}}\)</span>. However, maximum of GPL is equivalent to the maximum of the conventional one step ahead likelihood for a normal model in case, when all the basic <a href="#assumptions">assumptions</a> hold. In other cases, they would be different, but it is still not clear, whether the difference would be favouring the conventional likelihood of the GPL. Nonetheless, GPL, being the likelihood, guarantees that the estimates of parameters will be efficient and consistent and permits model selection and combination via information criteria.</p>
<p>When it comes to models with multiplicative error term, the formula of GPL <a href="multistepLosses.html#eq:logGPL">(11.15)</a> will need to be amended by analogy with the log-likelihood of normal distribution in the same situation (Table <a href="ADAMETSEstimationLikelihood.html#tab:multiplicativeErrorLikelihoods">11.2</a>):
<span class="math display" id="eq:logGPLMultiplicative">\[\begin{equation}
    \ell_{\mathrm{GPL}_h}(\theta, \mathbf{{\Sigma}} | \mathbf{Y}) = -\frac{T-h}{2} \left( h \log(2 \pi) + \log | \mathbf{{\Sigma}}| \right) -\frac{1}{2} \sum_{t=1}^T \left( \mathbf{E_t^\prime} \mathbf{{\Sigma}}^{-1} \mathbf{E_t} \right) - \sum_{t=1}^{T-h} \sum_{j=1}^h \log |\mu_{y,t+j|t}|,
  \tag{11.17}
\end{equation}\]</span>
where the term <span class="math inline">\(\sum_{t=1}^{T-h} \sum_{j=1}^h \log |\mu_{y,t+j|t}|\)</span> appears because we assume that the actual value <span class="math inline">\(h\)</span> steps ahead follows multivariate normal distribution with the conditional expectation <span class="math inline">\(\mu_{y,t+j|t}\)</span>. Note that this is only a very crude approximation, as the conditional distribution for <span class="math inline">\(h\)</span> steps ahead is not defined for models with multiplicative error models. So, when dealing with GPL, it is recommended to use pure additive models only.</p>
</div>
<div id="other-multistep-estimators" class="section level3" number="11.3.6">
<h3><span class="header-section-number">11.3.6</span> Other multistep estimators</h3>
<p>It is also possible to derive multistep estimators based on MAE, HAM and other error measures. adam() unofficially supports the following multistep losses by analogy with MSE<span class="math inline">\(_h\)</span>, TMSE and MSCE discussed in this section:</p>
<ol style="list-style-type: decimal">
<li>MAE<span class="math inline">\(_h\)</span>;</li>
<li>TMAE;</li>
<li>MACE;</li>
<li>HAM<span class="math inline">\(_h\)</span>;</li>
<li>THAM;</li>
<li>CHAM.</li>
</ol>
<p>When calculating likelihoods based on these losses, <code>adam()</code> will assume Laplace distribution for (1) - (3) and S distribution for (4) - (6).</p>
</div>
<div id="an-example-in-r-1" class="section level3" number="11.3.7">
<h3><span class="header-section-number">11.3.7</span> An example in R</h3>
<p>In order to see how different estimators perform, we will us Box-Jenkins Sales data, ETS(A,A,N) model and <span class="math inline">\(h=10\)</span>:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="multistepLosses.html#cb156-1" aria-hidden="true" tabindex="-1"></a>adamModel <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>,<span class="dv">6</span>)</span>
<span id="cb156-2"><a href="multistepLosses.html#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(adamModel) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MSE&quot;</span>,<span class="st">&quot;MSEh&quot;</span>,<span class="st">&quot;TMSE&quot;</span>,<span class="st">&quot;GTMSE&quot;</span>,<span class="st">&quot;MSCE&quot;</span>,<span class="st">&quot;GPL&quot;</span>)</span>
<span id="cb156-3"><a href="multistepLosses.html#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(adamModel)){</span>
<span id="cb156-4"><a href="multistepLosses.html#cb156-4" aria-hidden="true" tabindex="-1"></a>  adamModel[[i]] <span class="ot">&lt;-</span> <span class="fu">adam</span>(BJsales, <span class="st">&quot;AAN&quot;</span>, <span class="at">loss=</span><span class="fu">names</span>(adamModel)[i], <span class="at">h=</span><span class="dv">10</span>, <span class="at">holdout=</span><span class="cn">TRUE</span>)</span>
<span id="cb156-5"><a href="multistepLosses.html#cb156-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can compare the smoothing parameters of these models to see how the shrinkage effect worked in different estimators:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="multistepLosses.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sapply</span>(adamModel,<span class="st">&quot;[[&quot;</span>,<span class="st">&quot;persistence&quot;</span>),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##           MSE    MSEh    TMSE   GTMSE    MSCE     GPL
## alpha 0.99969 1.00000 0.99847 0.99998 0.99985 0.99998
## beta  0.24029 0.00497 0.00000 0.14315 0.11540 0.00001</code></pre>
<p>In the table above we can see that <span class="math inline">\(\beta\)</span> is close to zero for the estimators that impose harder shrinkage on parameters: MSE<span class="math inline">\(_h\)</span>, TMSE and MSCE. MSE does not shrink the parameters, while GTMSE has the mild shrinkage effect. While the models estimated using these losses are in general not comparable in-sample (although MSE, MSE<span class="math inline">\(_h\)</span>, MSCE and GPL could be compared via information criteria if they are scaled appropriately), they are comparable on the holdout:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="multistepLosses.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">sapply</span>(adamModel,<span class="st">&quot;[[&quot;</span>,<span class="st">&quot;accuracy&quot;</span>),<span class="dv">5</span>)[<span class="fu">c</span>(<span class="st">&quot;ME&quot;</span>,<span class="st">&quot;MAE&quot;</span>,<span class="st">&quot;MSE&quot;</span>),]</span></code></pre></div>
<pre><code>##          MSE    MSEh    TMSE    GTMSE     MSCE     GPL
## ME   3.22544 0.36928 0.95827  3.44916  3.38497 0.54948
## MAE  3.33751 1.10643 1.31767  3.53688  3.47967 1.09005
## MSE 14.38952 1.71733 2.63102 16.25939 15.70985 1.90315</code></pre>
<p>In this specific case, ETS(A,A,N) estimated using GPL produced more accurate forecast than based on the other estimators. Repeating the experiment on many samples and selecting the approach that produces more accurate forecasts would allow to select the most appropriate approach for the combination of the model + data.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Clements1998" class="csl-entry">
• Clements, M., Hendry, D., 1998. <span class="nocase">Forecasting economic time series</span>. Cambridge University Press, Cambridge.
</div>
<div id="ref-kourentzes2019unconstraining" class="csl-entry">
• Kourentzes, N., Li, D., Strauss, A.K., 2019b. Unconstraining methods for revenue management systems under small demand. Journal of Revenue and Pricing Management. 18, 27–41.
</div>
<div id="ref-Kourentzes2019" class="csl-entry">
• Kourentzes, N., Trapero, J.R., Barrow, D.K., 2019c. <span class="nocase">Optimising forecasting models for inventory planning</span>. International Journal of Production Economics. 107597. <a href="https://doi.org/10.1016/j.ijpe.2019.107597">https://doi.org/10.1016/j.ijpe.2019.107597</a>
</div>
<div id="ref-Svetunkov2020Multistep" class="csl-entry">
• Svetunkov, I., Kourentzes, N., Killick, R., 2021. <span class="nocase">Multi-step Estimators and Shrinkage Effect in Time Series Models</span>. <a href="https://doi.org/10.13140/RG.2.2.17854.31043">https://doi.org/10.13140/RG.2.2.17854.31043</a>
</div>
</div>

            </section>

          </div>
        </div>
      </div>
<a href="non-mle-based-loss-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ADAMInitialisation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/config-i1/adam/tree/master/Chapters//11-ADAM-Estimation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["adam.pdf", "adam.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
